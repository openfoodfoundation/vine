import{_ as D}from"./AuthenticatedLayout-R47MbXuc.js";import{o as s,c as l,b as e,t as $,r as v,e as V,d as o,f as E,g as U,F as k,h as N,n as q,a as g,w,j as b,u as j,Z as P,k as K,i as F}from"./app-D7vdOgIt.js";import{S as M,_ as W}from"./AdminTopNavigation-Fmss29Es.js";import{P as z}from"./PaginatorComponent-Y05VD0hV.js";import{P as C}from"./PrimaryButton-9z9RrTGZ.js";import{_ as I,a as A}from"./InputLabel-BCWRcgez.js";import{_ as L}from"./AdminTeamCreateComponent-CUQpTD3n.js";import{_ as O}from"./AdminUserDetailsComponent-Co0y9Bmi.js";import"./ApplicationLogo-D1AC-3fn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-Lp9hBCYQ.js";const Z={class:"text-xs"},G={class:""},S={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup(_){const c=_;return(h,m)=>(s(),l("div",null,[e("div",Z,"#"+$(c.team.id),1),e("div",G,$(c.team.name),1)]))}},H={key:0},J={key:1},Q={key:0,class:"mt-4 px-8"},R={class:"border-b py-1"},X=["onClick","disabled"],Y={key:1},B={__name:"AdminTeamSelectComponent",props:{excludeTeams:{required:!1,default:{}},teamId:{required:!1,default:null}},emits:["teamSelected"],setup(_,{emit:c}){const h=_,m=v(!1),a=v([]),i=v(""),r=v({}),y=c;V(()=>{x()});function x(){h.excludeTeams.data&&h.excludeTeams.data.length>0&&h.excludeTeams.data.forEach(t=>{t.service_team_id&&a.value.push(t.service_team_id),t.merchant_team_id&&a.value.push(t.merchant_team_id)}),h.teamId&&a.value.push(h.teamId)}function u(){axios.get("/admin/teams?where[]=name,like,*"+i.value+"*&limit=100").then(t=>{r.value=t.data.data}).catch(t=>{console.log(t)})}function f(){m.value=!0,r.value={}}function p(t){n(t)}function n(t){y("teamSelected",t),i.value="",r.value={}}return(t,d)=>m.value?(s(),l("div",H,[o(L,{searchStr:i.value,onTeamCreated:p},null,8,["searchStr"])])):(s(),l("div",J,[e("div",null,[o(I,{for:"name",value:"Team name(Type to search and press Enter)"}),o(A,{onKeyup:d[0]||(d[0]=E(U(T=>u(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=T=>i.value=T),required:""},null,8,["modelValue"])]),i.value.length>0&&r.value.total>0?(s(),l("div",Q,[(s(!0),l(k,null,N(r.value.data,T=>(s(),l("div",R,[e("button",{onClick:at=>n(T),class:q(["cursor-pointer flex justify-start items-end",{"text-gray-500 cursor-not-allowed":a.value.includes(T.id)}]),disabled:a.value.includes(T.id)},[o(S,{team:T},null,8,["team"])],10,X)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:d[2]||(d[2]=T=>f())}," Create a new team? ")])):g("",!0),i.value.length>0&&r.value.total===0?(s(),l("div",Y,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:d[3]||(d[3]=T=>f())}," We could not find teams. Do you want to create a new team? ")])):g("",!0)]))}},ee={class:"flex justify-end"},te={key:0},ae=e("div",{class:"py-2"},"Select merchant team...",-1),se={key:1},ne={class:"py-2"},le={class:"font-bold"},de={key:2},ie={key:0,class:"mb-2"},oe={class:"mb-2 font-semibold"},re={class:"border-b py-1"},ce={key:1,class:"mb-2"},me={class:"mb-2 font-semibold"},ue={class:"border-b py-1"},ve={key:2},_e={__name:"AdminTeamMerchantTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(_){const c=_,h=v(!1),m=v(!1),a=v({}),i=v({}),r=v({});V(()=>{x(),u()});function y(){h.value=!0}function x(){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+c.teamId+"&relations=merchantTeam").then(n=>{a.value=n.data.data}).catch(n=>{console.log(n)})}function u(){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+c.teamId+"&relations=team").then(n=>{i.value=n.data.data}).catch(n=>{console.log(n)})}function f(){let n={team_id:c.teamId,merchant_team_id:r.value.id};axios.post("/admin/team-merchant-teams",n).then(t=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{r.value={},m.value=!1,x(),u()})}).catch(t=>{console.log(t)})}function p(n){r.value=n,h.value=!1,m.value=!0}return(n,t)=>(s(),l(k,null,[e("div",ee,[o(C,{onClick:t[0]||(t[0]=d=>y()),class:"ms-4"},{default:w(()=>[b(" Add Merchant Team ")]),_:1})]),h.value?(s(),l("div",te,[ae,o(B,{excludeTeams:a.value,teamId:_.teamId,onTeamSelected:p},null,8,["excludeTeams","teamId"])])):m.value?(s(),l("div",se,[e("div",ne,[b("Adding "),e("span",le,$(r.value.name),1),b(" as merchant team?")]),o(C,{onClick:t[1]||(t[1]=d=>f()),class:"ms-4"},{default:w(()=>[b(" Add ")]),_:1})])):(s(),l("div",de,[a.value.data&&a.value.data.length?(s(),l("div",ie,[e("div",oe,$(_.teamName)+"'s merchant teams",1),(s(!0),l(k,null,N(a.value.data,d=>(s(),l("div",re,[o(S,{team:d.merchant_team},null,8,["team"])]))),256))])):g("",!0),i.value.data&&i.value.data.length?(s(),l("div",ce,[e("div",me,$(_.teamName)+" is merchant team for",1),(s(!0),l(k,null,N(i.value.data,d=>(s(),l("div",ue,[o(S,{team:d.team},null,8,["team"])]))),256))])):g("",!0),a.value.data&&a.value.data.length===0&&i.value.data&&i.value.data.length===0?(s(),l("div",ve,$(_.teamName)+" does not have merchant teams ",1)):g("",!0)]))],64))}},he={class:"flex justify-end"},fe={key:0},pe=e("div",{class:"py-2"},"Select service team...",-1),$e={key:1},ge={class:"py-2"},ye={class:"font-bold"},xe={key:2},be={key:0,class:"mb-2"},Te={class:"mb-2 font-semibold"},ke={class:"border-b py-1"},we={key:1,class:"mb-2"},Ne={class:"mb-2 font-semibold"},Se={class:"border-b py-1"},Ce={key:2},Ie={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(_){const c=_,h=v(!1),m=v(!1),a=v({}),i=v({}),r=v({});V(()=>{x(),u()});function y(){h.value=!0}function x(){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+c.teamId+"&relations=serviceTeam").then(n=>{a.value=n.data.data}).catch(n=>{console.log(n)})}function u(){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+c.teamId+"&relations=team").then(n=>{i.value=n.data.data}).catch(n=>{console.log(n)})}function f(){let n={team_id:c.teamId,service_team_id:r.value.id};axios.post("/admin/team-service-teams",n).then(t=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{r.value={},m.value=!1,x(),u()})}).catch(t=>{console.log(t)})}function p(n){r.value=n,h.value=!1,m.value=!0}return(n,t)=>(s(),l(k,null,[e("div",he,[o(C,{onClick:t[0]||(t[0]=d=>y()),class:"ms-4"},{default:w(()=>[b(" Add Service Team ")]),_:1})]),h.value?(s(),l("div",fe,[pe,o(B,{excludeTeams:a.value,teamId:_.teamId,onTeamSelected:p},null,8,["excludeTeams","teamId"])])):m.value?(s(),l("div",$e,[e("div",ge,[b("Adding "),e("span",ye,$(r.value.name),1),b(" as service team?")]),o(C,{onClick:t[1]||(t[1]=d=>f()),class:"ms-4"},{default:w(()=>[b(" Add ")]),_:1})])):(s(),l("div",xe,[a.value.data&&a.value.data.length?(s(),l("div",be,[e("div",Te,$(_.teamName)+"'s service teams",1),(s(!0),l(k,null,N(a.value.data,d=>(s(),l("div",ke,[o(S,{team:d.service_team},null,8,["team"])]))),256))])):g("",!0),i.value.data&&i.value.data.length?(s(),l("div",we,[e("div",Ne,$(_.teamName)+" is service team for",1),(s(!0),l(k,null,N(i.value.data,d=>(s(),l("div",Se,[o(S,{team:d.team},null,8,["team"])]))),256))])):g("",!0),a.value.data&&a.value.data.length===0&&i.value.data&&i.value.data.length===0?(s(),l("div",Ce,$(_.teamName)+" does not have service teams ",1)):g("",!0)]))],64))}},Ae={key:0},Ve={class:"flex items-center justify-end mt-4"},Ue={key:1},qe={key:0,class:"mt-4 px-8"},Me={class:"border-b py-1"},je=["onClick"],Ee={key:1},Be={__name:"AdminUserSelectComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup(_,{emit:c}){const h=_,m=v(!1),a=v({name:"",email:"",current_team_id:null}),i=v(""),r=v({}),y=c;function x(){a.value.current_team_id=h.teamId,axios.post("admin/users",a.value).then(n=>{let t=n.data.data.id;p(t),a.value={name:"",email:"",current_team_id:null},m.value=!1}).catch(n=>{console.log(n)})}function u(){axios.get("/admin/users?search="+i.value+"&limit=100").then(n=>{r.value=n.data.data}).catch(n=>{console.log(n)})}function f(){m.value=!0,r.value={},a.value.name=i.value}function p(n){y("createNewTeamUser",n),i.value="",r.value={}}return(n,t)=>m.value?(s(),l("div",Ae,[e("div",null,[o(I,{for:"name",value:"Name"}),o(A,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=d=>a.value.name=d),required:""},null,8,["modelValue"])]),e("div",null,[o(I,{for:"email",value:"Email"}),o(A,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a.value.email,"onUpdate:modelValue":t[1]||(t[1]=d=>a.value.email=d),required:""},null,8,["modelValue"])]),e("div",Ve,[o(C,{onClick:t[2]||(t[2]=U(d=>x(),["prevent"])),class:q(["ms-4",{"opacity-25":!a.value.name||!a.value.email}]),disabled:!a.value.name||!a.value.email},{default:w(()=>[b(" Submit ")]),_:1},8,["class","disabled"])])])):(s(),l("div",Ue,[e("div",null,[o(I,{for:"name",value:"Name / Email (Type to search and press Enter)"}),o(A,{onKeyup:t[3]||(t[3]=E(U(d=>u(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=d=>i.value=d),required:""},null,8,["modelValue"])]),i.value.length>0&&r.value.total>0?(s(),l("div",qe,[(s(!0),l(k,null,N(r.value.data,d=>(s(),l("div",Me,[e("div",{onClick:T=>p(d.id),class:"cursor-pointer"},[o(O,{user:d},null,8,["user"])],8,je)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:t[5]||(t[5]=d=>f())}," Create a new user? ")])):g("",!0),i.value.length>0&&r.value.total===0?(s(),l("div",Ee,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:t[6]||(t[6]=d=>f())}," We could not find users. Do you want to create a new user? ")])):g("",!0)]))}},De={class:"card"},Pe={class:""},Ke={class:"card"},Fe=e("div",{class:"card-header"}," Team details ",-1),We={class:"card"},ze=e("div",{class:"card-header"}," Team members ",-1),Le={key:0},Oe={key:0,class:"flex items-center"},Ze={class:"flex justify-end items-center mt-4"},Ge={class:"w-full lg:w-1/3"},He={class:"card"},Je=e("div",{class:"card-header"}," Add user to team ",-1),Qe={class:"card"},Re=e("div",{class:"card-header"}," Merchant teams ",-1),Xe={class:"card"},Ye=e("div",{class:"card-header"}," Service teams ",-1),et=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets created by team"),b(" - paginated ")],-1),tt=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets allocated to team"),b(" - paginated ")],-1),_t={__name:"Team",props:{id:{required:!0,type:Number}},setup(_){const c=_,h=v(5),m=v({}),a=v({});V(()=>{r(),y()});function i(u){let f={user_id:u,team_id:c.id};axios.post("/admin/team-users",f).then(p=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{y()})}).catch(p=>{console.log(p)})}function r(){axios.get("/admin/teams/"+c.id+"?cached=false").then(u=>{m.value=u.data.data}).catch(u=>{console.log(u)})}function y(u=1){axios.get("/admin/team-users?cached=false&page="+u+"&where[]=team_id,"+c.id+"&relations=user&limit="+h.value+"&orderBy=id,desc").then(f=>{a.value=f.data.data}).catch(f=>{console.log(f)})}function x(u){y(u)}return(u,f)=>(s(),l(k,null,[o(j(P),{title:"Team"}),o(D,null,{header:w(()=>[o(W)]),default:w(()=>[e("div",De,[e("div",Pe,[e("h2",null,$(m.value.name),1),e("div",null,"#"+$(c.id),1)])]),e("div",Ke,[Fe,o(S,{team:m.value},null,8,["team"])]),e("div",We,[ze,a.value.data&&a.value.data.length>0?(s(),l("div",Le,[(s(!0),l(k,null,N(a.value.data,p=>(s(),K(j(F),{href:u.route("admin.user",p.user_id),class:"hover:no-underline hover:opacity-75"},{default:w(()=>[e("div",{class:q({"border-b p-2":a.value.data.length>1})},[p.user?(s(),l("div",Oe,[e("div",null,$(p.user.name),1)])):g("",!0)],2)]),_:2},1032,["href"]))),256))])):g("",!0),e("div",Ze,[e("div",Ge,[o(z,{onSetDataPage:x,"pagination-data":a.value},null,8,["pagination-data"])])])]),e("div",He,[Je,o(Be,{teamId:c.id,onCreateNewTeamUser:i},null,8,["teamId"])]),e("div",Qe,[Re,o(_e,{teamId:c.id,teamName:m.value.name},null,8,["teamId","teamName"])]),e("div",Xe,[Ye,o(Ie,{teamId:c.id,teamName:m.value.name},null,8,["teamId","teamName"])]),et,tt]),_:1})],64))}};export{_t as default};
