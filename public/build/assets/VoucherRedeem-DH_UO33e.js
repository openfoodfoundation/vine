import{r as _,o as V,q as F,c as s,a as i,b as p,u as x,m as $,w as C,d as e,f,t as n,e as u,k as T,n as B,s as P,F as b,g as A}from"./app-BxiwYAhG.js";import{_ as I,S as m}from"./AuthenticatedLayout-DF8nzIcE.js";import{d as h}from"./dayjs.min-uj46lva8.js";import{r as N}from"./relativeTime-Ytxw0Kyv.js";import{u as j}from"./utc-Bu2gc9cG.js";import"./ApplicationLogo-B1_YcDB2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./PrimaryButton-BXPmiZo7.js";const D={class:"card"},S={class:"title text-2xl"},L={class:"uppercase"},q={class:"my-4"},M={key:0,class:"title text-green text-xl text-green-500"},O={key:1,class:"title"},z={key:2,class:"title text-red text-lg text-red-500"},E={class:"text-2xl font-bold mt-12"},H={key:3,class:"mt-12"},U={key:0},G={class:"my-4"},J={key:0,class:"my-2 text-red-500"},K={key:0,class:"flex justify-between items-center"},Q={class:"w-1/2 pr-2"},W={class:"w-1/2 pl-2"},X={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-2"},Y={class:""},Z={class:""},ee={key:4,class:"mt-8"},te={key:5,class:"mt-12 text-left"},oe={class:"title"},se={class:"flex justify-between items-center py-2 border-b"},ie={class:"text-lg"},re={class:"text-center"},le={class:"text-xs"},xe={__name:"VoucherRedeem",props:{voucher:{type:Object,required:!0}},setup(r){h.extend(N),h.extend(j);const d=r,c=_(!1),a=_(0),v=_(!1);V(()=>{});function y(){a.value=(parseInt(d.voucher.voucher_value_remaining)/100).toFixed(2),c.value=!0}function w(){c.value=!1}function k(){c.value=!1,m.fire({title:"Redeem all $"+(d.voucher.voucher_value_remaining/100).toFixed(2)+"?",html:"<p>This will fully redeem this voucher.</p>",icon:"warning",showCancelButton:!0,confirmButtonText:"Redeem!"}).then(l=>{l.value&&g(d.voucher.voucher_value_remaining.toFixed(0))})}function R(){m.fire({title:"Redeem $"+a.value+"?",html:"<p>This will partially redeem this voucher.</p>",icon:"warning",showCancelButton:!0,confirmButtonText:"Redeem!"}).then(l=>{l.value&&g((a.value*100).toFixed(0))})}function g(l){let t={voucher_id:d.voucher.id,voucher_set_id:d.voucher.voucher_set_id,amount:l};axios.post("/voucher-redemptions",t).then(o=>{m.fire({icon:"success",title:"Redeemed.",text:o.data.meta.message}),c.value=!1,setTimeout(ne=>{window.location.reload()},1e3)}).catch(o=>{m.fire({icon:"error",title:"Oops!",text:o.response.data.meta.message})})}return F(a,l=>{v.value=l>0&&parseInt((l*100).toFixed(0))<=parseInt(d.voucher.voucher_value_remaining.toFixed(0))}),(l,t)=>(i(),s(b,null,[p(x($),{title:"Voucher redeem"}),p(I,null,{default:C(()=>[e("div",D,[e("div",S,[t[5]||(t[5]=f(" Redeem Voucher ")),e("span",L,n(r.voucher.voucher_short_code),1)]),e("div",q,[r.voucher.voucher_value_remaining>0?(i(),s("div",M,"Voucher is Valid")):(i(),s("div",O,"Voucher is Fully Redeemed!")),r.voucher.is_test?(i(),s("div",z," This is a test voucher. ")):u("",!0),e("div",null,[e("div",E," $"+n((r.voucher.voucher_value_remaining/100).toFixed(2))+" remaining ",1),e("div",null," of $"+n((r.voucher.voucher_value_original/100).toFixed(2))+" original value ",1)]),r.voucher.voucher_value_remaining>0?(i(),s("div",H,[c.value?(i(),s("div",U,[e("div",G,[t[6]||(t[6]=f(" How much should be redeemed? ")),T(e("input",{inputmode:"decimal",pattern:"[0-9]*",type:"text",step:"0.01","onUpdate:modelValue":t[0]||(t[0]=o=>a.value=o),class:B(["w-full text-center text-xl rounded p-8 border-2 focus:outline-none",{"border-green-500":v.value,"border-red-500":!v.value}]),min:"0.01"},null,2),[[P,a.value,void 0,{number:!0}]]),v.value?u("",!0):(i(),s("div",J," Invalid redemption amount. "))]),v.value?(i(),s("div",K,[e("div",Q,[e("button",{class:"w-full p-8 font-bold text-2xl rounded border bg-gray-300",onClick:t[1]||(t[1]=o=>w())}," Cancel ")]),e("div",W,[e("button",{class:"w-full p-8 font-bold text-2xl rounded border bg-gray-300",onClick:t[2]||(t[2]=o=>R())}," Redeem ")])])):u("",!0)])):(i(),s("div",X,[e("div",Y,[e("button",{class:"w-full p-8 font-bold text-2xl rounded border bg-gray-300",onClick:t[3]||(t[3]=o=>y())}," Redeem PART ")]),e("div",Z,[e("button",{class:"w-full p-8 font-bold text-2xl rounded border bg-gray-300",onClick:t[4]||(t[4]=o=>k())}," Redeem ALL ")])]))])):u("",!0),r.voucher.voucher_redemptions?u("",!0):(i(),s("div",ee,t[7]||(t[7]=[e("button",{class:"w-full p-2 rounded border"}," See Redemptions ",-1)]))),r.voucher.voucher_redemptions?(i(),s("div",te,[e("div",oe," Redemptions ("+n(r.voucher.voucher_redemptions.length)+") ",1),e("div",null,[(i(!0),s(b,null,A(r.voucher.voucher_redemptions,o=>(i(),s("div",se,[e("div",null,[e("div",ie," $"+n((o.redeemed_amount/100).toFixed(2)),1)]),e("div",re,[f(n(x(h).utc(o.created_at).fromNow())+" ",1),e("div",le," ("+n(x(h)(o.created_at))+") ",1)])]))),256))])])):u("",!0)])])]),_:1})],64))}};export{xe as default};
