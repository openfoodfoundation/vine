import{_ as F}from"./AuthenticatedLayout-DSVsSXG6.js";import{a as s,b as n,e as a,t as $,r as _,d as i,l as U,m as q,F as T,j as S,h as y,o as D,w as k,f as w,u as N,i as j,n as K,Z as W}from"./app-ClCJcWW-.js";import{_ as z}from"./AdminTopNavigation-yTEVNZVX.js";import{P as M}from"./PaginatorComponent-Bu2dN7Jx.js";import{S as P}from"./sweetalert2.all-BxHbwWoH.js";import{P as C}from"./PrimaryButton-DnWz4roc.js";import{_ as A}from"./TextInput-Dluw6uBu.js";import{_ as V}from"./InputLabel-1FzjMa0D.js";import{_ as E}from"./AdminTeamCreateComponent-CUa7YuLx.js";import{_ as L}from"./AdminUserDetailsComponent-C4TSDZmY.js";import{_ as O}from"./SecondaryButton-Bv260Y3G.js";import{_ as R}from"./AjaxLoadingIndicator-ClxHAKXA.js";import{d as B}from"./dayjs.min-DFKnUh4F.js";import{r as Z}from"./relativeTime-xAqRU6fB.js";import"./ApplicationLogo-BahlM8sz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"flex justify-start items-center"},H={class:"text-xs mr-2"},J={class:""},I={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup(c){const m=c;return(h,r)=>(s(),n("div",G,[a("div",H,"#"+$(m.team.id),1),a("div",J,$(m.team.name),1)]))}},Q={key:0},X={key:1},Y={key:0,class:"mt-4"},ee={class:"border-b py-1"},te=["onClick"],ae={key:0,class:"text-red-500 text-xs italic pl-2"},se={key:1},ne={__name:"AdminTeamMerchantTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(c,{emit:m}){const h=c,r=_(!1),l=_(""),d=_({}),u=m;function b(){axios.get("/admin/teams?where[]=name,like,*"+l.value+"*&limit=100&relations=teamsThisTeamIsMerchantFor").then(o=>{d.value=o.data.data}).catch(o=>{console.log(o)})}function g(){r.value=!0,d.value={}}function x(o){p(o)}function p(o){u("teamSelected",o),l.value="",d.value={}}function v(o){return o.teams_this_team_is_merchant_for.find(e=>e.team_id===h.teamId)}return(o,e)=>r.value?(s(),n("div",Q,[i(E,{searchStr:l.value,onTeamCreated:x},null,8,["searchStr"])])):(s(),n("div",X,[a("div",null,[i(V,{for:"name",value:"Team name(Type to search and press Enter)"}),i(A,{onKeyup:e[0]||(e[0]=U(q(t=>b(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),required:""},null,8,["modelValue"])]),l.value.length>0&&d.value.total>0?(s(),n("div",Y,[(s(!0),n(T,null,S(d.value.data,t=>(s(),n("div",ee,[a("button",{onClick:f=>p(t),class:"flex justify-start items-end"},[i(I,{team:t},null,8,["team"]),v(t)?(s(),n("span",ae,"***Already added")):y("",!0)],8,te)]))),256)),a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[2]||(e[2]=t=>g())}," Create a new team? ")])):y("",!0),l.value.length>0&&d.value.total===0?(s(),n("div",se,[a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[3]||(e[3]=t=>g())}," We could not find teams. Do you want to create a new team? ")])):y("",!0)]))}},le={class:"flex justify-end"},ie={key:0},oe={key:1},de={key:0},re=a("div",{class:"py-2"},"Select merchant team...",-1),ce={key:1},me={class:"py-2"},ue={class:"font-bold"},ve={key:2},_e={key:0,class:"mb-8"},he={class:"mb-2 font-semibold"},fe={class:"text-xs italic"},pe={class:"border-b py-1"},$e={class:"flex justify-end items-center mt-4"},ge={class:"w-full lg:w-1/3"},ye={key:1,class:"mb-8"},xe={class:"mb-2 font-semibold"},ke={class:"text-xs italic"},we={class:"border-b py-1"},be={class:"flex justify-end items-center mt-4"},Te={class:"w-full lg:w-1/3"},Se={key:2},Ne={__name:"AdminTeamMerchantTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(c){const m=c,h=_(!1),r=_(!1),l=_({}),d=_({}),u=_({});D(()=>{x(),p()});function b(){h.value=!0}function g(){h.value=!1,r.value=!1,u.value={}}function x(e=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+m.teamId+"&page="+e+"&relations=merchantTeam").then(t=>{l.value=t.data.data}).catch(t=>{console.log(t)})}function p(e=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+m.teamId+"&page="+e+"&relations=team").then(t=>{d.value=t.data.data}).catch(t=>{console.log(t)})}function v(){let e={team_id:m.teamId,merchant_team_id:u.value.id};axios.post("/admin/team-merchant-teams",e).then(t=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{u.value={},r.value=!1,x(),p()})}).catch(t=>{console.log(t)})}function o(e){u.value=e,h.value=!1,r.value=!0}return(e,t)=>(s(),n(T,null,[a("div",le,[!h.value&&!r.value?(s(),n("div",ie,[i(C,{onClick:t[0]||(t[0]=f=>b()),class:"ms-4"},{default:k(()=>[w(" Add Merchant Team ")]),_:1})])):(s(),n("div",oe,[i(C,{onClick:t[1]||(t[1]=f=>g()),class:"ms-4"},{default:k(()=>[w(" Cancel ")]),_:1})]))]),h.value?(s(),n("div",de,[re,i(ne,{teamId:c.teamId,onTeamSelected:o},null,8,["teamId"])])):r.value?(s(),n("div",ce,[a("div",me,[w("Add "),a("span",ue,$(u.value.name),1),w(" as merchant team?")]),i(C,{onClick:t[2]||(t[2]=f=>v()),class:""},{default:k(()=>[w(" Add ")]),_:1})])):(s(),n("div",ve,[l.value.data&&l.value.data.length?(s(),n("div",_e,[a("div",null,[a("div",he,$(c.teamName)+"'s merchant teams ",1),a("div",fe," Teams that may redeem vouchers for "+$(c.teamName),1)]),(s(!0),n(T,null,S(l.value.data,f=>(s(),n("div",pe,[i(N(j),{href:e.route("admin.team",f.merchant_team_id)},{default:k(()=>[i(I,{team:f.merchant_team},null,8,["team"])]),_:2},1032,["href"])]))),256)),a("div",$e,[a("div",ge,[i(M,{onSetDataPage:x,"pagination-data":l.value},null,8,["pagination-data"])])])])):y("",!0),d.value.data&&d.value.data.length?(s(),n("div",ye,[a("div",null,[a("div",xe,$(c.teamName)+" is merchant team for ",1),a("div",ke,$(c.teamName)+" may redeem vouchers for these teams ",1)]),(s(!0),n(T,null,S(d.value.data,f=>(s(),n("div",we,[i(N(j),{href:e.route("admin.team",f.team_id)},{default:k(()=>[i(I,{team:f.team},null,8,["team"])]),_:2},1032,["href"])]))),256)),a("div",be,[a("div",Te,[i(M,{onSetDataPage:p,"pagination-data":d.value},null,8,["pagination-data"])])])])):y("",!0),l.value.data&&l.value.data.length===0&&d.value.data&&d.value.data.length===0?(s(),n("div",Se,$(c.teamName)+" does not have merchant teams ",1)):y("",!0)]))],64))}},Ce={key:0},Ie={key:1},Ae={key:0,class:"mt-4"},Ve={class:"border-b py-1"},je=["onClick"],Me={key:0,class:"text-red-500 text-xs italic pl-2"},qe={key:1},Ue={__name:"AdminTeamServiceTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(c,{emit:m}){const h=c,r=_(!1),l=_(""),d=_({}),u=m;function b(){axios.get("/admin/teams?where[]=name,like,*"+l.value+"*&limit=100&relations=teamsThisTeamIsServiceFor").then(o=>{d.value=o.data.data}).catch(o=>{console.log(o)})}function g(){r.value=!0,d.value={}}function x(o){p(o)}function p(o){u("teamSelected",o),l.value="",d.value={}}function v(o){return o.teams_this_team_is_service_for.find(e=>e.team_id===h.teamId)}return(o,e)=>r.value?(s(),n("div",Ce,[i(E,{searchStr:l.value,onTeamCreated:x},null,8,["searchStr"])])):(s(),n("div",Ie,[a("div",null,[i(V,{for:"name",value:"Team name(Type to search and press Enter)"}),i(A,{onKeyup:e[0]||(e[0]=U(q(t=>b(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),required:""},null,8,["modelValue"])]),l.value.length>0&&d.value.total>0?(s(),n("div",Ae,[(s(!0),n(T,null,S(d.value.data,t=>(s(),n("div",Ve,[a("button",{onClick:f=>p(t),class:"flex justify-start items-end"},[i(I,{team:t},null,8,["team"]),v(t)?(s(),n("span",Me,"***Already added")):y("",!0)],8,je)]))),256)),a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[2]||(e[2]=t=>g())}," Create a new team? ")])):y("",!0),l.value.length>0&&d.value.total===0?(s(),n("div",qe,[a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[3]||(e[3]=t=>g())}," We could not find teams. Do you want to create a new team? ")])):y("",!0)]))}},De={class:"flex justify-end"},Pe={key:0},Be={key:1},Ee={key:0},Fe=a("div",{class:"py-2"},"Select service team...",-1),Ke={key:1},We={class:"py-2"},ze={class:"font-bold"},Le={key:2},Oe={key:0,class:"mb-8"},Re={class:"mb-2 font-semibold"},Ze={class:"text-xs italic"},Ge={class:"border-b py-1"},He={class:"flex justify-end items-center mt-4"},Je={class:"w-full lg:w-1/3"},Qe={key:1,class:"mb-8"},Xe={class:"mb-2 font-semibold"},Ye={class:"text-xs italic"},et={class:"border-b py-1"},tt={class:"flex justify-end items-center mt-4"},at={class:"w-full lg:w-1/3"},st={key:2},nt={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(c){const m=c,h=_(!1),r=_(!1),l=_({}),d=_({}),u=_({});D(()=>{x(),p()});function b(){h.value=!0}function g(){h.value=!1,r.value=!1,u.value={}}function x(e=1){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+m.teamId+"&page="+e+"&relations=serviceTeam").then(t=>{l.value=t.data.data}).catch(t=>{console.log(t)})}function p(e=1){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+m.teamId+"&page="+e+"&relations=team").then(t=>{d.value=t.data.data}).catch(t=>{console.log(t)})}function v(){let e={team_id:m.teamId,service_team_id:u.value.id};axios.post("/admin/team-service-teams",e).then(t=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{u.value={},r.value=!1,x(),p()})}).catch(t=>{console.log(t)})}function o(e){u.value=e,h.value=!1,r.value=!0}return(e,t)=>(s(),n(T,null,[a("div",De,[!h.value&&!r.value?(s(),n("div",Pe,[i(C,{onClick:t[0]||(t[0]=f=>b()),class:"ms-4"},{default:k(()=>[w(" Add Service Team ")]),_:1})])):(s(),n("div",Be,[i(C,{onClick:t[1]||(t[1]=f=>g()),class:"ms-4"},{default:k(()=>[w(" Cancel ")]),_:1})]))]),h.value?(s(),n("div",Ee,[Fe,i(Ue,{teamId:c.teamId,onTeamSelected:o},null,8,["teamId"])])):r.value?(s(),n("div",Ke,[a("div",We,[w("Adding "),a("span",ze,$(u.value.name),1),w(" as service team?")]),i(C,{onClick:t[2]||(t[2]=f=>v()),class:""},{default:k(()=>[w(" Add ")]),_:1})])):(s(),n("div",Le,[l.value.data&&l.value.data.length?(s(),n("div",Oe,[a("div",null,[a("div",Re,$(c.teamName)+"'s service teams ",1),a("div",Ze,$(c.teamName)+" may assign voucher sets for distribution to these teams ",1)]),(s(!0),n(T,null,S(l.value.data,f=>(s(),n("div",Ge,[i(N(j),{href:e.route("admin.team",f.service_team_id)},{default:k(()=>[i(I,{team:f.service_team},null,8,["team"])]),_:2},1032,["href"])]))),256)),a("div",He,[a("div",Je,[i(M,{onSetDataPage:x,"pagination-data":l.value},null,8,["pagination-data"])])])])):y("",!0),d.value.data&&d.value.data.length?(s(),n("div",Qe,[a("div",null,[a("div",Xe,$(c.teamName)+" is service team for ",1),a("div",Ye,$(c.teamName)+" may be assigned voucher sets for distribution by these teams ",1)]),(s(!0),n(T,null,S(d.value.data,f=>(s(),n("div",et,[i(N(j),{href:e.route("admin.team",f.team_id)},{default:k(()=>[i(I,{team:f.team},null,8,["team"])]),_:2},1032,["href"])]))),256)),a("div",tt,[a("div",at,[i(M,{onSetDataPage:p,"pagination-data":d.value},null,8,["pagination-data"])])])])):y("",!0),l.value.data&&l.value.data.length===0&&d.value.data&&d.value.data.length===0?(s(),n("div",st,$(c.teamName)+" does not have service teams ",1)):y("",!0)]))],64))}},lt={key:0},it={class:"flex items-center justify-end mt-4"},ot={key:1},dt={key:0,class:"mt-4 px-8"},rt={class:"border-b py-1"},ct=["onClick"],mt={key:1},ut={__name:"AdminUserSelectComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup(c,{emit:m}){const h=c,r=_(!1),l=_({name:"",email:"",current_team_id:null}),d=_(""),u=_({}),b=m;function g(){l.value.current_team_id=h.teamId,axios.post("admin/users",l.value).then(o=>{let e=o.data.data.id;v(e),l.value={name:"",email:"",current_team_id:null},r.value=!1}).catch(o=>{console.log(o)})}function x(){axios.get("/admin/users?search="+d.value+"&limit=100").then(o=>{u.value=o.data.data}).catch(o=>{console.log(o)})}function p(){r.value=!0,u.value={},l.value.name=d.value}function v(o){b("createNewTeamUser",o),d.value="",u.value={}}return(o,e)=>r.value?(s(),n("div",lt,[a("div",null,[i(V,{for:"name",value:"Name"}),i(A,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.name=t),required:""},null,8,["modelValue"])]),a("div",null,[i(V,{for:"email",value:"Email"}),i(A,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:l.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.email=t),required:""},null,8,["modelValue"])]),a("div",it,[i(C,{onClick:e[2]||(e[2]=q(t=>g(),["prevent"])),class:K(["ms-4",{"opacity-25":!l.value.name||!l.value.email}]),disabled:!l.value.name||!l.value.email},{default:k(()=>[w(" Submit ")]),_:1},8,["class","disabled"])])])):(s(),n("div",ot,[a("div",null,[i(V,{for:"name",value:"Name / Email (Type to search and press Enter)"}),i(A,{onKeyup:e[3]||(e[3]=U(q(t=>x(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),required:""},null,8,["modelValue"])]),d.value.length>0&&u.value.total>0?(s(),n("div",dt,[(s(!0),n(T,null,S(u.value.data,t=>(s(),n("div",rt,[a("div",{onClick:f=>v(t.id),class:"cursor-pointer"},[i(L,{user:t},null,8,["user"])],8,ct)]))),256)),a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[5]||(e[5]=t=>p())}," Create a new user? ")])):y("",!0),d.value.length>0&&u.value.total===0?(s(),n("div",mt,[a("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:e[6]||(e[6]=t=>p())}," We could not find users. Do you want to create a new user? ")])):y("",!0)]))}},vt={class:"card"},_t={class:""},ht={class:"card"},ft=a("div",{class:"card-header"}," Team details ",-1),pt={class:"card"},$t=a("div",{class:"card-header"}," Team members ",-1),gt={key:0},yt={class:"flex hover:opacity-75"},xt={class:"flex justify-end items-center"},kt={key:0,class:"pr-2 text-xs"},wt=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})],-1),bt={key:0},Tt={key:1,class:"px-2"},St={key:2,class:"px-2"},Nt={class:"flex justify-end items-center mt-4"},Ct={class:"w-full lg:w-1/3"},It={class:"card"},At=a("div",{class:"card-header"}," Add user to team ",-1),Vt={class:"card"},jt=a("div",{class:"card-header"}," Merchant teams ",-1),Mt={class:"card"},qt=a("div",{class:"card-header"}," Service teams ",-1),Ut=a("div",{class:"card"},[a("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets created by team"),w(" - paginated ")],-1),Dt=a("div",{class:"card"},[a("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets allocated to team"),w(" - paginated ")],-1),Yt={__name:"Team",props:{id:{required:!0,type:Number}},setup(c){B.extend(Z);const m=c,h=_(5),r=_({}),l=_({}),d=_(!1);D(()=>{b(),g()});function u(v){let o={user_id:v,team_id:m.id};axios.post("/admin/team-users",o).then(e=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{g()})}).catch(e=>{console.log(e)})}function b(){axios.get("/admin/teams/"+m.id+"?cached=false").then(v=>{r.value=v.data.data}).catch(v=>{console.log(v)})}function g(v=1){axios.get("/admin/team-users?cached=false&page="+v+"&where[]=team_id,"+m.id+"&relations=user&limit="+h.value+"&orderBy=id,desc").then(o=>{l.value=o.data.data}).catch(o=>{console.log(o)})}function x(v){d.value=!0;let o={send_invite_email:!0};axios.put("/admin/team-users/"+v.id,o).then(e=>{g(),d.value=!1}).catch(e=>{console.log(e),d.value=!1})}function p(v){g(v)}return(v,o)=>(s(),n(T,null,[i(N(W),{title:"Team"}),i(F,null,{header:k(()=>[i(z)]),default:k(()=>[a("div",vt,[a("div",_t,[a("h2",null,$(r.value.name),1),a("div",null,"#"+$(m.id),1)])]),a("div",ht,[ft,i(I,{team:r.value},null,8,["team"])]),a("div",pt,[i(R,{loading:d.value},null,8,["loading"]),$t,l.value.data&&l.value.data.length>0?(s(),n("div",gt,[(s(!0),n(T,null,S(l.value.data,e=>(s(),n("div",yt,[i(N(j),{href:v.route("admin.user",e.user_id),class:"border-b p-2 mr-2 flex-grow flex justify-between items-center hover:no-underline"},{default:k(()=>{var t;return[a("div",null,$((t=e.user)==null?void 0:t.name),1),a("div",xt,[e.invitation_sent_at?(s(),n("div",kt," Invited: "+$(N(B)(e.invitation_sent_at).fromNow()),1)):y("",!0),wt])]}),_:2},1032,["href"]),i(O,{onClick:t=>x(e)},{default:k(()=>[a("div",null,[e.invitation_sent_at?(s(),n("div",bt,"Resend Invite")):d.value?(s(),n("div",Tt,"Sending..")):(s(),n("div",St,"Send Invite"))])]),_:2},1032,["onClick"])]))),256))])):y("",!0),a("div",Nt,[a("div",Ct,[i(M,{onSetDataPage:p,"pagination-data":l.value},null,8,["pagination-data"])])])]),a("div",It,[At,i(ut,{teamId:m.id,onCreateNewTeamUser:u},null,8,["teamId"])]),a("div",Vt,[jt,i(Ne,{teamId:m.id,teamName:r.value.name},null,8,["teamId","teamName"])]),a("div",Mt,[qt,i(nt,{teamId:m.id,teamName:r.value.name},null,8,["teamId","teamName"])]),Ut,Dt]),_:1})],64))}};export{Yt as default};
