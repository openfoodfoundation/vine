import{_ as D}from"./AuthenticatedLayout-CPH-HHPY.js";import{r as p,o as s,c as n,b as e,d as i,w as k,e as f,f as I,n as q,g as j,F as x,h as T,a as b,t as c,j as V,u as U,Z as P,k as E,i as K}from"./app-D39v8M-d.js";import{S as M,_ as F}from"./AdminTopNavigation-Bf9vftIr.js";import{P as W}from"./PaginatorComponent-CZMgHw-s.js";import{_ as C,a as A}from"./InputLabel-DmwcC91m.js";import{_ as z}from"./AdminUserDetailsComponent-BOeVfyIS.js";import{P as w}from"./PrimaryButton-BhYs-ebo.js";import{_ as L}from"./AdminTeamCreateComponent-Ci7Lzp1W.js";import"./ApplicationLogo-qg3dnkiT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-CNzQpbJ5.js";const O={key:0},Z={class:"flex items-center justify-end mt-4"},G={key:1},H={key:0,class:"mt-4 px-8"},J={class:"border-b py-1"},Q=["onClick"],R={key:1},X={__name:"AdminUserSearchComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup($,{emit:d}){const g=$,m=p(!1),a=p({name:"",email:"",current_team_id:null}),u=p(""),r=p({}),y=d;function N(){a.value.current_team_id=g.teamId,axios.post("admin/users",a.value).then(t=>{let l=t.data.data.id;h(l),a.value={name:"",email:"",current_team_id:null},m.value=!1}).catch(t=>{console.log(t)})}function _(){axios.get("/admin/users?search="+u.value+"&limit=100").then(t=>{r.value=t.data.data}).catch(t=>{console.log(t)})}function v(){m.value=!0,r.value={},a.value.name=u.value}function h(t){y("createNewTeamUser",t),u.value="",r.value={}}return(t,l)=>m.value?(s(),n("div",O,[e("div",null,[i(C,{for:"name",value:"Name"}),i(A,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:a.value.name,"onUpdate:modelValue":l[0]||(l[0]=o=>a.value.name=o),required:""},null,8,["modelValue"])]),e("div",null,[i(C,{for:"email",value:"Email"}),i(A,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a.value.email,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.email=o),required:""},null,8,["modelValue"])]),e("div",Z,[i(w,{onClick:l[2]||(l[2]=I(o=>N(),["prevent"])),class:q(["ms-4",{"opacity-25":!a.value.name||!a.value.email}]),disabled:!a.value.name||!a.value.email},{default:k(()=>[f(" Submit ")]),_:1},8,["class","disabled"])])])):(s(),n("div",G,[e("div",null,[i(C,{for:"name",value:"Name / Email (Type to search and press Enter)"}),i(A,{onKeyup:l[3]||(l[3]=j(I(o=>_(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=o=>u.value=o),required:""},null,8,["modelValue"])]),u.value.length>0&&r.value.total>0?(s(),n("div",H,[(s(!0),n(x,null,T(r.value.data,o=>(s(),n("div",J,[e("div",{onClick:ht=>h(o.id),class:"cursor-pointer"},[i(z,{user:o},null,8,["user"])],8,Q)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:l[5]||(l[5]=o=>v())}," Create a new user? ")])):b("",!0),u.value.length>0&&r.value.total===0?(s(),n("div",R,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:l[6]||(l[6]=o=>v())}," We could not find users. Do you want to create a new user? ")])):b("",!0)]))}},Y={class:"text-xs"},ee={class:""},S={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup($){const d=$;return(g,m)=>(s(),n("div",null,[e("div",Y,"#"+c(d.team.id),1),e("div",ee,c(d.team.name),1)]))}},te={key:0},ae={key:1},se={key:0,class:"mt-4 px-8"},ne={class:"border-b py-1"},le=["onClick"],de={key:1},B={__name:"AdminTeamSearchComponent",emits:["teamSelected"],setup($,{emit:d}){const g=p(!1),m=p(""),a=p({}),u=d;function r(){axios.get("/admin/teams?where[]=name,like,*"+m.value+"*&limit=100").then(v=>{a.value=v.data.data}).catch(v=>{console.log(v)})}function y(){g.value=!0,a.value={}}function N(v){_(v)}function _(v){u("teamSelected",v),m.value="",a.value={}}return(v,h)=>g.value?(s(),n("div",te,[i(L,{searchStr:m.value,onTeamCreated:N},null,8,["searchStr"])])):(s(),n("div",ae,[e("div",null,[i(C,{for:"name",value:"Team name(Type to search and press Enter)"}),i(A,{onKeyup:h[0]||(h[0]=j(I(t=>r(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=t=>m.value=t),required:""},null,8,["modelValue"])]),m.value.length>0&&a.value.total>0?(s(),n("div",se,[(s(!0),n(x,null,T(a.value.data,t=>(s(),n("div",ne,[e("div",{onClick:l=>_(t),class:"cursor-pointer"},[i(S,{team:t},null,8,["team"])],8,le)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:h[2]||(h[2]=t=>y())}," Create a new team? ")])):b("",!0),m.value.length>0&&a.value.total===0?(s(),n("div",de,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:h[3]||(h[3]=t=>y())}," We could not find teams. Do you want to create a new team? ")])):b("",!0)]))}},oe={class:"flex justify-end"},ie={key:0},re=e("div",{class:"py-2"},"Select merchant team...",-1),ce={key:1},me={class:"flex items-center"},ue={class:"pr-20 border-r"},ve={class:"py-2"},_e={class:"font-bold"},he={class:"font-bold"},fe={class:"pl-20"},pe={class:"py-2"},$e={class:"font-bold"},ge={class:"font-bold"},ye={key:2},be={key:0,class:"mb-2"},Ne={class:"mb-2 font-semibold"},ke={class:"border-b py-1"},xe={key:1,class:"mb-2"},we={class:"mb-2 font-semibold"},Te={class:"border-b py-1"},Se={key:2},Ce={__name:"AdminTeamMerchantTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup($){const d=$,g=p(!1),m=p(!1),a=p({}),u=p({}),r=p({});V(()=>{N(),_()});function y(){g.value=!0}function N(){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+d.teamId+"&relations=merchantTeam").then(t=>{a.value=t.data.data}).catch(t=>{console.log(t)})}function _(){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+d.teamId+"&relations=team").then(t=>{u.value=t.data.data}).catch(t=>{console.log(t)})}function v(t){let l={team_id:d.teamId,merchant_team_id:r.value.id};t==="addedAsMerchant"&&(l={team_id:r.value.id,merchant_team_id:d.teamId}),axios.post("/admin/team-merchant-teams",l).then(o=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{r.value={},m.value=!1,N(),_()})}).catch(o=>{console.log(o)})}function h(t){r.value=t,g.value=!1,m.value=!0}return(t,l)=>(s(),n(x,null,[e("div",oe,[i(w,{onClick:l[0]||(l[0]=o=>y()),class:"ms-4"},{default:k(()=>[f(" Add Merchant Team ")]),_:1})]),g.value?(s(),n("div",ie,[re,i(B,{onTeamSelected:h})])):m.value?(s(),n("div",ce,[e("div",me,[e("div",ue,[e("div",ve,[f("Adding "),e("span",_e,c(r.value.name),1),f(" as "),e("span",he,c(d.teamName),1),f("'s merchant.")]),i(w,{onClick:l[1]||(l[1]=o=>v("getNewMerchant")),class:"ms-4"},{default:k(()=>[f(" Add "+c(r.value.name)+" as merchant for "+c(d.teamName),1)]),_:1})]),e("div",fe,[e("div",pe,[f("Adding "),e("span",$e,c(d.teamName),1),f(" as "),e("span",ge,c(r.value.name),1),f("'s merchant.")]),i(w,{onClick:l[2]||(l[2]=o=>v("addedAsMerchant")),class:"ms-4"},{default:k(()=>[f(" Add "+c(d.teamName)+" as merchant for "+c(r.value.name),1)]),_:1})])])])):(s(),n("div",ye,[a.value.data&&a.value.data.length?(s(),n("div",be,[e("div",Ne,c($.teamName)+"'s merchant teams",1),(s(!0),n(x,null,T(a.value.data,o=>(s(),n("div",ke,[i(S,{team:o.merchant_team},null,8,["team"])]))),256))])):b("",!0),u.value.data&&u.value.data.length?(s(),n("div",xe,[e("div",we,c($.teamName)+" is merchant team for",1),(s(!0),n(x,null,T(u.value.data,o=>(s(),n("div",Te,[i(S,{team:o.team},null,8,["team"])]))),256))])):b("",!0),a.value.data&&a.value.data.length===0&&u.value.data&&u.value.data.length===0?(s(),n("div",Se,c($.teamName)+" does not have merchant teams ",1)):b("",!0)]))],64))}},Ae={class:"flex justify-end"},Ie={key:0},Ve=e("div",{class:"py-2"},"Select service team...",-1),Me={key:1},Ue={class:"flex items-center"},qe={class:"pr-20 border-r"},je={class:"py-2"},Be={class:"font-bold"},De={class:"font-bold"},Pe={class:"pl-20"},Ee={class:"py-2"},Ke={class:"font-bold"},Fe={class:"font-bold"},We={key:2},ze={key:0,class:"mb-2"},Le={class:"mb-2 font-semibold"},Oe={class:"border-b py-1"},Ze={key:1,class:"mb-2"},Ge={class:"mb-2 font-semibold"},He={class:"border-b py-1"},Je={key:2},Qe={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup($){const d=$,g=p(!1),m=p(!1),a=p({}),u=p({}),r=p({});V(()=>{N(),_()});function y(){g.value=!0}function N(){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+d.teamId+"&relations=serviceTeam").then(t=>{a.value=t.data.data}).catch(t=>{console.log(t)})}function _(){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+d.teamId+"&relations=team").then(t=>{u.value=t.data.data}).catch(t=>{console.log(t)})}function v(t){let l={team_id:d.teamId,service_team_id:r.value.id};t==="addedAsService"&&(l={team_id:r.value.id,service_team_id:d.teamId}),axios.post("/admin/team-service-teams",l).then(o=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{r.value={},m.value=!1,N(),_()})}).catch(o=>{console.log(o)})}function h(t){r.value=t,g.value=!1,m.value=!0}return(t,l)=>(s(),n(x,null,[e("div",Ae,[i(w,{onClick:l[0]||(l[0]=o=>y()),class:"ms-4"},{default:k(()=>[f(" Add Service Team ")]),_:1})]),g.value?(s(),n("div",Ie,[Ve,i(B,{onTeamSelected:h})])):m.value?(s(),n("div",Me,[e("div",Ue,[e("div",qe,[e("div",je,[f("Adding "),e("span",Be,c(r.value.name),1),f(" as "),e("span",De,c(d.teamName),1),f("'s service.")]),i(w,{onClick:l[1]||(l[1]=o=>v("getNewService")),class:"ms-4"},{default:k(()=>[f(" Add "+c(r.value.name)+" as service for "+c(d.teamName),1)]),_:1})]),e("div",Pe,[e("div",Ee,[f("Adding "),e("span",Ke,c(d.teamName),1),f(" as "),e("span",Fe,c(r.value.name),1),f("'s service.")]),i(w,{onClick:l[2]||(l[2]=o=>v("addedAsService")),class:"ms-4"},{default:k(()=>[f(" Add "+c(d.teamName)+" as service for "+c(r.value.name),1)]),_:1})])])])):(s(),n("div",We,[a.value.data&&a.value.data.length?(s(),n("div",ze,[e("div",Le,c($.teamName)+"'s service teams",1),(s(!0),n(x,null,T(a.value.data,o=>(s(),n("div",Oe,[i(S,{team:o.service_team},null,8,["team"])]))),256))])):b("",!0),u.value.data&&u.value.data.length?(s(),n("div",Ze,[e("div",Ge,c($.teamName)+" is service team for",1),(s(!0),n(x,null,T(u.value.data,o=>(s(),n("div",He,[i(S,{team:o.team},null,8,["team"])]))),256))])):b("",!0),a.value.data&&a.value.data.length===0&&u.value.data&&u.value.data.length===0?(s(),n("div",Je,c($.teamName)+" does not have service teams ",1)):b("",!0)]))],64))}},Re={class:"card"},Xe={class:""},Ye={class:"card"},et=e("div",{class:"card-header"}," Team details ",-1),tt={class:"card"},at=e("div",{class:"card-header"}," Team members ",-1),st={key:0},nt={key:0,class:"flex items-center"},lt={class:"flex justify-end items-center mt-4"},dt={class:"w-full lg:w-1/3"},ot={class:"card"},it=e("div",{class:"card-header"}," Add user to team ",-1),rt={class:"card"},ct=e("div",{class:"card-header"}," Merchant teams ",-1),mt={class:"card"},ut=e("div",{class:"card-header"}," Service teams ",-1),vt=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets created by team"),f(" - paginated ")],-1),_t=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets allocated to team"),f(" - paginated ")],-1),St={__name:"Team",props:{id:{required:!0,type:Number}},setup($){const d=$,g=p(5),m=p({}),a=p({});V(()=>{r(),y()});function u(_){let v={user_id:_,team_id:d.id};axios.post("/admin/team-users",v).then(h=>{M.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{y()})}).catch(h=>{console.log(h)})}function r(){axios.get("/admin/teams/"+d.id+"?cached=false").then(_=>{m.value=_.data.data}).catch(_=>{console.log(_)})}function y(_=1){axios.get("/admin/team-users?cached=false&page="+_+"&where[]=team_id,"+d.id+"&relations=user&limit="+g.value+"&orderBy=id,desc").then(v=>{a.value=v.data.data}).catch(v=>{console.log(v)})}function N(_){y(_)}return(_,v)=>(s(),n(x,null,[i(U(P),{title:"Team"}),i(D,null,{header:k(()=>[i(F)]),default:k(()=>[e("div",Re,[e("div",Xe,[e("h2",null,c(m.value.name),1),e("div",null,"#"+c(d.id),1)])]),e("div",Ye,[et,i(S,{team:m.value},null,8,["team"])]),e("div",tt,[at,a.value.data&&a.value.data.length>0?(s(),n("div",st,[(s(!0),n(x,null,T(a.value.data,h=>(s(),E(U(K),{href:_.route("admin.user",h.user_id),class:"hover:no-underline hover:opacity-75"},{default:k(()=>[e("div",{class:q({"border-b p-2":a.value.data.length>1})},[h.user?(s(),n("div",nt,[e("div",null,c(h.user.name),1)])):b("",!0)],2)]),_:2},1032,["href"]))),256))])):b("",!0),e("div",lt,[e("div",dt,[i(W,{onSetDataPage:N,"pagination-data":a.value},null,8,["pagination-data"])])])]),e("div",ot,[it,i(X,{teamId:d.id,onCreateNewTeamUser:u},null,8,["teamId"])]),e("div",rt,[ct,i(Ce,{teamId:d.id,teamName:m.value.name},null,8,["teamId","teamName"])]),e("div",mt,[ut,i(Qe,{teamId:d.id,teamName:m.value.name},null,8,["teamId","teamName"])]),vt,_t]),_:1})],64))}};export{St as default};
