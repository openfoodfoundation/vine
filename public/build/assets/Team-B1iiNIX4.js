import{_ as F}from"./AuthenticatedLayout-fdh2LT__.js";import{a as s,b as l,e,t as g,r as h,d as i,l as j,m as q,F as T,j as S,h as y,o as D,w as x,f as w,u as I,i as M,n as B,Z as K,k as W}from"./app-CLWo_2_0.js";import{_ as z}from"./AdminTopNavigation-B_k0Rku1.js";import{P as U}from"./PaginatorComponent-we2oJGu8.js";import{S as P}from"./sweetalert2.all-CR-AECOm.js";import{P as N}from"./PrimaryButton-DzdjS49d.js";import{_ as A}from"./TextInput-BoZkehg1.js";import{_ as V}from"./InputLabel-Bbc6sIKf.js";import{_ as E}from"./AdminTeamCreateComponent-DE__6kEd.js";import{_ as L}from"./AdminUserDetailsComponent-BTcetsGB.js";import"./ApplicationLogo-BOnuEcuS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-CPtVldUf.js";const O={class:"flex justify-start items-center"},Z={class:"text-xs mr-2"},G={class:""},C={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup(m){const u=m;return(f,r)=>(s(),l("div",O,[e("div",Z,"#"+g(u.team.id),1),e("div",G,g(u.team.name),1)]))}},H={key:0},J={key:1},Q={key:0,class:"mt-4"},R={class:"border-b py-1"},X=["onClick"],Y={key:0,class:"text-red-500 text-xs italic pl-2"},ee={key:1},te={__name:"AdminTeamMerchantTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(m,{emit:u}){const f=m,r=h(!1),n=h(""),o=h({}),v=u;function k(){axios.get("/admin/teams?where[]=name,like,*"+n.value+"*&limit=100&relations=teamsThisTeamIsMerchantFor").then(d=>{o.value=d.data.data}).catch(d=>{console.log(d)})}function b(){r.value=!0,o.value={}}function c(d){_(d)}function _(d){v("teamSelected",d),n.value="",o.value={}}function $(d){return d.teams_this_team_is_merchant_for.find(a=>a.team_id===f.teamId)}return(d,a)=>r.value?(s(),l("div",H,[i(E,{searchStr:n.value,onTeamCreated:c},null,8,["searchStr"])])):(s(),l("div",J,[e("div",null,[i(V,{for:"name",value:"Team name(Type to search and press Enter)"}),i(A,{onKeyup:a[0]||(a[0]=j(q(t=>k(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value=t),required:""},null,8,["modelValue"])]),n.value.length>0&&o.value.total>0?(s(),l("div",Q,[(s(!0),l(T,null,S(o.value.data,t=>(s(),l("div",R,[e("button",{onClick:p=>_(t),class:"flex justify-start items-end"},[i(C,{team:t},null,8,["team"]),$(t)?(s(),l("span",Y,"***Already added")):y("",!0)],8,X)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[2]||(a[2]=t=>b())}," Create a new team? ")])):y("",!0),n.value.length>0&&o.value.total===0?(s(),l("div",ee,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[3]||(a[3]=t=>b())}," We could not find teams. Do you want to create a new team? ")])):y("",!0)]))}},ae={class:"flex justify-end"},se={key:0},ne={key:1},le={key:0},ie=e("div",{class:"py-2"},"Select merchant team...",-1),oe={key:1},de={class:"py-2"},re={class:"font-bold"},me={key:2},ce={key:0,class:"mb-8"},ue={class:"mb-2 font-semibold"},ve={class:"text-xs italic"},_e={class:"border-b py-1"},he={class:"flex justify-end items-center mt-4"},fe={class:"w-full lg:w-1/3"},pe={key:1,class:"mb-8"},$e={class:"mb-2 font-semibold"},ge={class:"text-xs italic"},ye={class:"border-b py-1"},xe={class:"flex justify-end items-center mt-4"},ke={class:"w-full lg:w-1/3"},be={key:2},we={__name:"AdminTeamMerchantTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(m){const u=m,f=h(!1),r=h(!1),n=h({}),o=h({}),v=h({});D(()=>{c(),_()});function k(){f.value=!0}function b(){f.value=!1,r.value=!1,v.value={}}function c(a=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+u.teamId+"&page="+a+"&relations=merchantTeam").then(t=>{n.value=t.data.data}).catch(t=>{console.log(t)})}function _(a=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+u.teamId+"&page="+a+"&relations=team").then(t=>{o.value=t.data.data}).catch(t=>{console.log(t)})}function $(){let a={team_id:u.teamId,merchant_team_id:v.value.id};axios.post("/admin/team-merchant-teams",a).then(t=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{v.value={},r.value=!1,c(),_()})}).catch(t=>{console.log(t)})}function d(a){v.value=a,f.value=!1,r.value=!0}return(a,t)=>(s(),l(T,null,[e("div",ae,[!f.value&&!r.value?(s(),l("div",se,[i(N,{onClick:t[0]||(t[0]=p=>k()),class:"ms-4"},{default:x(()=>[w(" Add Merchant Team ")]),_:1})])):(s(),l("div",ne,[i(N,{onClick:t[1]||(t[1]=p=>b()),class:"ms-4"},{default:x(()=>[w(" Cancel ")]),_:1})]))]),f.value?(s(),l("div",le,[ie,i(te,{teamId:m.teamId,onTeamSelected:d},null,8,["teamId"])])):r.value?(s(),l("div",oe,[e("div",de,[w("Add "),e("span",re,g(v.value.name),1),w(" as merchant team?")]),i(N,{onClick:t[2]||(t[2]=p=>$()),class:""},{default:x(()=>[w(" Add ")]),_:1})])):(s(),l("div",me,[n.value.data&&n.value.data.length?(s(),l("div",ce,[e("div",null,[e("div",ue,g(m.teamName)+"'s merchant teams ",1),e("div",ve," Teams that may redeem vouchers for "+g(m.teamName),1)]),(s(!0),l(T,null,S(n.value.data,p=>(s(),l("div",_e,[i(I(M),{href:a.route("admin.team",p.merchant_team_id)},{default:x(()=>[i(C,{team:p.merchant_team},null,8,["team"])]),_:2},1032,["href"])]))),256)),e("div",he,[e("div",fe,[i(U,{onSetDataPage:c,"pagination-data":n.value},null,8,["pagination-data"])])])])):y("",!0),o.value.data&&o.value.data.length?(s(),l("div",pe,[e("div",null,[e("div",$e,g(m.teamName)+" is merchant team for ",1),e("div",ge,g(m.teamName)+" may redeem vouchers for these teams ",1)]),(s(!0),l(T,null,S(o.value.data,p=>(s(),l("div",ye,[i(I(M),{href:a.route("admin.team",p.team_id)},{default:x(()=>[i(C,{team:p.team},null,8,["team"])]),_:2},1032,["href"])]))),256)),e("div",xe,[e("div",ke,[i(U,{onSetDataPage:_,"pagination-data":o.value},null,8,["pagination-data"])])])])):y("",!0),n.value.data&&n.value.data.length===0&&o.value.data&&o.value.data.length===0?(s(),l("div",be,g(m.teamName)+" does not have merchant teams ",1)):y("",!0)]))],64))}},Te={key:0},Se={key:1},Ne={key:0,class:"mt-4"},Ce={class:"border-b py-1"},Ie=["onClick"],Ae={key:0,class:"text-red-500 text-xs italic pl-2"},Ve={key:1},Me={__name:"AdminTeamServiceTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(m,{emit:u}){const f=m,r=h(!1),n=h(""),o=h({}),v=u;function k(){axios.get("/admin/teams?where[]=name,like,*"+n.value+"*&limit=100&relations=teamsThisTeamIsServiceFor").then(d=>{o.value=d.data.data}).catch(d=>{console.log(d)})}function b(){r.value=!0,o.value={}}function c(d){_(d)}function _(d){v("teamSelected",d),n.value="",o.value={}}function $(d){return d.teams_this_team_is_service_for.find(a=>a.team_id===f.teamId)}return(d,a)=>r.value?(s(),l("div",Te,[i(E,{searchStr:n.value,onTeamCreated:c},null,8,["searchStr"])])):(s(),l("div",Se,[e("div",null,[i(V,{for:"name",value:"Team name(Type to search and press Enter)"}),i(A,{onKeyup:a[0]||(a[0]=j(q(t=>k(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value=t),required:""},null,8,["modelValue"])]),n.value.length>0&&o.value.total>0?(s(),l("div",Ne,[(s(!0),l(T,null,S(o.value.data,t=>(s(),l("div",Ce,[e("button",{onClick:p=>_(t),class:"flex justify-start items-end"},[i(C,{team:t},null,8,["team"]),$(t)?(s(),l("span",Ae,"***Already added")):y("",!0)],8,Ie)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[2]||(a[2]=t=>b())}," Create a new team? ")])):y("",!0),n.value.length>0&&o.value.total===0?(s(),l("div",Ve,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[3]||(a[3]=t=>b())}," We could not find teams. Do you want to create a new team? ")])):y("",!0)]))}},Ue={class:"flex justify-end"},qe={key:0},je={key:1},De={key:0},Pe=e("div",{class:"py-2"},"Select service team...",-1),Be={key:1},Ee={class:"py-2"},Fe={class:"font-bold"},Ke={key:2},We={key:0,class:"mb-8"},ze={class:"mb-2 font-semibold"},Le={class:"text-xs italic"},Oe={class:"border-b py-1"},Ze={class:"flex justify-end items-center mt-4"},Ge={class:"w-full lg:w-1/3"},He={key:1,class:"mb-8"},Je={class:"mb-2 font-semibold"},Qe={class:"text-xs italic"},Re={class:"border-b py-1"},Xe={class:"flex justify-end items-center mt-4"},Ye={class:"w-full lg:w-1/3"},et={key:2},tt={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(m){const u=m,f=h(!1),r=h(!1),n=h({}),o=h({}),v=h({});D(()=>{c(),_()});function k(){f.value=!0}function b(){f.value=!1,r.value=!1,v.value={}}function c(a=1){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+u.teamId+"&page="+a+"&relations=serviceTeam").then(t=>{n.value=t.data.data}).catch(t=>{console.log(t)})}function _(a=1){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+u.teamId+"&page="+a+"&relations=team").then(t=>{o.value=t.data.data}).catch(t=>{console.log(t)})}function $(){let a={team_id:u.teamId,service_team_id:v.value.id};axios.post("/admin/team-service-teams",a).then(t=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{v.value={},r.value=!1,c(),_()})}).catch(t=>{console.log(t)})}function d(a){v.value=a,f.value=!1,r.value=!0}return(a,t)=>(s(),l(T,null,[e("div",Ue,[!f.value&&!r.value?(s(),l("div",qe,[i(N,{onClick:t[0]||(t[0]=p=>k()),class:"ms-4"},{default:x(()=>[w(" Add Service Team ")]),_:1})])):(s(),l("div",je,[i(N,{onClick:t[1]||(t[1]=p=>b()),class:"ms-4"},{default:x(()=>[w(" Cancel ")]),_:1})]))]),f.value?(s(),l("div",De,[Pe,i(Me,{teamId:m.teamId,onTeamSelected:d},null,8,["teamId"])])):r.value?(s(),l("div",Be,[e("div",Ee,[w("Adding "),e("span",Fe,g(v.value.name),1),w(" as service team?")]),i(N,{onClick:t[2]||(t[2]=p=>$()),class:""},{default:x(()=>[w(" Add ")]),_:1})])):(s(),l("div",Ke,[n.value.data&&n.value.data.length?(s(),l("div",We,[e("div",null,[e("div",ze,g(m.teamName)+"'s service teams ",1),e("div",Le,g(m.teamName)+" may assign voucher sets for distribution to these teams ",1)]),(s(!0),l(T,null,S(n.value.data,p=>(s(),l("div",Oe,[i(I(M),{href:a.route("admin.team",p.service_team_id)},{default:x(()=>[i(C,{team:p.service_team},null,8,["team"])]),_:2},1032,["href"])]))),256)),e("div",Ze,[e("div",Ge,[i(U,{onSetDataPage:c,"pagination-data":n.value},null,8,["pagination-data"])])])])):y("",!0),o.value.data&&o.value.data.length?(s(),l("div",He,[e("div",null,[e("div",Je,g(m.teamName)+" is service team for ",1),e("div",Qe,g(m.teamName)+" may be assigned voucher sets for distribution by these teams ",1)]),(s(!0),l(T,null,S(o.value.data,p=>(s(),l("div",Re,[i(I(M),{href:a.route("admin.team",p.team_id)},{default:x(()=>[i(C,{team:p.team},null,8,["team"])]),_:2},1032,["href"])]))),256)),e("div",Xe,[e("div",Ye,[i(U,{onSetDataPage:_,"pagination-data":o.value},null,8,["pagination-data"])])])])):y("",!0),n.value.data&&n.value.data.length===0&&o.value.data&&o.value.data.length===0?(s(),l("div",et,g(m.teamName)+" does not have service teams ",1)):y("",!0)]))],64))}},at={key:0},st={class:"flex items-center justify-end mt-4"},nt={key:1},lt={key:0,class:"mt-4 px-8"},it={class:"border-b py-1"},ot=["onClick"],dt={key:1},rt={__name:"AdminUserSelectComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup(m,{emit:u}){const f=m,r=h(!1),n=h({name:"",email:"",current_team_id:null}),o=h(""),v=h({}),k=u;function b(){n.value.current_team_id=f.teamId,axios.post("admin/users",n.value).then(d=>{let a=d.data.data.id;$(a),n.value={name:"",email:"",current_team_id:null},r.value=!1}).catch(d=>{console.log(d)})}function c(){axios.get("/admin/users?search="+o.value+"&limit=100").then(d=>{v.value=d.data.data}).catch(d=>{console.log(d)})}function _(){r.value=!0,v.value={},n.value.name=o.value}function $(d){k("createNewTeamUser",d),o.value="",v.value={}}return(d,a)=>r.value?(s(),l("div",at,[e("div",null,[i(V,{for:"name",value:"Name"}),i(A,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.name=t),required:""},null,8,["modelValue"])]),e("div",null,[i(V,{for:"email",value:"Email"}),i(A,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:n.value.email,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.email=t),required:""},null,8,["modelValue"])]),e("div",st,[i(N,{onClick:a[2]||(a[2]=q(t=>b(),["prevent"])),class:B(["ms-4",{"opacity-25":!n.value.name||!n.value.email}]),disabled:!n.value.name||!n.value.email},{default:x(()=>[w(" Submit ")]),_:1},8,["class","disabled"])])])):(s(),l("div",nt,[e("div",null,[i(V,{for:"name",value:"Name / Email (Type to search and press Enter)"}),i(A,{onKeyup:a[3]||(a[3]=j(q(t=>c(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:o.value,"onUpdate:modelValue":a[4]||(a[4]=t=>o.value=t),required:""},null,8,["modelValue"])]),o.value.length>0&&v.value.total>0?(s(),l("div",lt,[(s(!0),l(T,null,S(v.value.data,t=>(s(),l("div",it,[e("div",{onClick:p=>$(t.id),class:"cursor-pointer"},[i(L,{user:t},null,8,["user"])],8,ot)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[5]||(a[5]=t=>_())}," Create a new user? ")])):y("",!0),o.value.length>0&&v.value.total===0?(s(),l("div",dt,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:a[6]||(a[6]=t=>_())}," We could not find users. Do you want to create a new user? ")])):y("",!0)]))}},mt={class:"card"},ct={class:""},ut={class:"card"},vt=e("div",{class:"card-header"}," Team details ",-1),_t={class:"card"},ht=e("div",{class:"card-header"}," Team members ",-1),ft={key:0},pt={key:0,class:"flex items-center"},$t={class:"flex justify-end items-center mt-4"},gt={class:"w-full lg:w-1/3"},yt={class:"card"},xt=e("div",{class:"card-header"}," Add user to team ",-1),kt={class:"card"},bt=e("div",{class:"card-header"}," Merchant teams ",-1),wt={class:"card"},Tt=e("div",{class:"card-header"}," Service teams ",-1),St=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets created by team"),w(" - paginated ")],-1),Nt=e("div",{class:"card"},[e("div",{class:"text-sm pb-2 text-gray-500"},"Voucher sets allocated to team"),w(" - paginated ")],-1),Kt={__name:"Team",props:{id:{required:!0,type:Number}},setup(m){const u=m,f=h(5),r=h({}),n=h({});D(()=>{v(),k()});function o(c){let _={user_id:c,team_id:u.id};axios.post("/admin/team-users",_).then($=>{P.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{k()})}).catch($=>{console.log($)})}function v(){axios.get("/admin/teams/"+u.id+"?cached=false").then(c=>{r.value=c.data.data}).catch(c=>{console.log(c)})}function k(c=1){axios.get("/admin/team-users?cached=false&page="+c+"&where[]=team_id,"+u.id+"&relations=user&limit="+f.value+"&orderBy=id,desc").then(_=>{n.value=_.data.data}).catch(_=>{console.log(_)})}function b(c){k(c)}return(c,_)=>(s(),l(T,null,[i(I(K),{title:"Team"}),i(F,null,{header:x(()=>[i(z)]),default:x(()=>[e("div",mt,[e("div",ct,[e("h2",null,g(r.value.name),1),e("div",null,"#"+g(u.id),1)])]),e("div",ut,[vt,i(C,{team:r.value},null,8,["team"])]),e("div",_t,[ht,n.value.data&&n.value.data.length>0?(s(),l("div",ft,[(s(!0),l(T,null,S(n.value.data,$=>(s(),W(I(M),{href:c.route("admin.user",$.user_id),class:"hover:no-underline hover:opacity-75"},{default:x(()=>[e("div",{class:B({"border-b p-2":n.value.data.length>1})},[$.user?(s(),l("div",pt,[e("div",null,g($.user.name),1)])):y("",!0)],2)]),_:2},1032,["href"]))),256))])):y("",!0),e("div",$t,[e("div",gt,[i(U,{onSetDataPage:b,"pagination-data":n.value},null,8,["pagination-data"])])])]),e("div",yt,[xt,i(rt,{teamId:u.id,onCreateNewTeamUser:o},null,8,["teamId"])]),e("div",kt,[bt,i(we,{teamId:u.id,teamName:r.value.name},null,8,["teamId","teamName"])]),e("div",wt,[Tt,i(tt,{teamId:u.id,teamName:r.value.name},null,8,["teamId","teamName"])]),St,Nt]),_:1})],64))}};export{Kt as default};
