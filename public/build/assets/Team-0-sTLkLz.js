import{a as s,b as n,e as t,t as w,r as _,d as i,l as K,m as q,F as S,j as A,h as $,o as z,w as g,f as y,u as N,i as V,n as W,Z as L}from"./app-BGNfv28m.js";import{_ as R}from"./AuthenticatedLayout-nRJKbbi3.js";import{_ as Y}from"./AdminTopNavigation-CQQ26_XV.js";import{P as B}from"./PaginatorComponent-UDqfJcTS.js";import{S as T}from"./sweetalert2.esm.all-BccGxJ0c.js";import{P as I}from"./PrimaryButton-Cld03qfE.js";import{_ as D}from"./TextInput-DVQ_D8Nt.js";import{_ as U}from"./InputLabel-B8MVZ4sg.js";import{_ as O}from"./AdminTeamCreateComponent-L9vb6MMB.js";import{_ as Z}from"./AdminUserDetailsComponent-DAb8YH9O.js";import{_ as G}from"./SecondaryButton-BNoxN6EZ.js";import{_ as H}from"./AjaxLoadingIndicator-CCBHGDZS.js";import{d as P}from"./dayjs.min-B6jxOc78.js";import{r as J}from"./relativeTime-Bb7I1EyG.js";import{u as Q}from"./utc-BsR5fft1.js";import{D as X}from"./DangerButton-B_5Kmt88.js";import{_ as F}from"./VoucherSetsComponent-DdLfrSu_.js";import{_ as E}from"./VouchersComponent-DVlFyESP.js";import"./ApplicationLogo-COY4qw4C.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"flex justify-start items-center"},te={class:"text-xs mr-2"},ae={class:""},M={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup(h){const c=h;return(v,f)=>(s(),n("div",ee,[t("div",te,"#"+w(c.team.id),1),t("div",ae,w(c.team.name),1)]))}},se={key:0},ne={key:1},ie={key:0,class:"mt-4"},le={class:"border-b py-1"},oe=["onClick"],de={key:0,class:"text-red-500 text-xs italic pl-2"},re={key:1},ue={__name:"AdminTeamMerchantTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(h,{emit:c}){const v=h,f=_(!1),o=_(""),l=_({}),m=c;function C(){axios.get("/admin/teams?where[]=name,like,*"+o.value+"*&limit=100&relations=teamsThisTeamIsMerchantFor").then(u=>{l.value=u.data.data}).catch(u=>{console.log(u)})}function k(){f.value=!0,l.value={}}function p(u){x(u)}function x(u){m("teamSelected",u),o.value="",l.value={}}function b(u){return u.teams_this_team_is_merchant_for.find(r=>r.team_id===v.teamId)}return(u,r)=>f.value?(s(),n("div",se,[i(O,{searchStr:o.value,onTeamCreated:p},null,8,["searchStr"])])):(s(),n("div",ne,[t("div",null,[i(U,{for:"name",value:"Team name(Type to search and press Enter)"}),i(D,{onKeyup:r[0]||(r[0]=K(q(a=>C(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:o.value,"onUpdate:modelValue":r[1]||(r[1]=a=>o.value=a),required:""},null,8,["modelValue"])]),o.value.length>0&&l.value.total>0?(s(),n("div",ie,[(s(!0),n(S,null,A(l.value.data,a=>(s(),n("div",le,[t("button",{onClick:e=>x(a),class:"flex justify-start items-end"},[i(M,{team:a},null,8,["team"]),b(a)?(s(),n("span",de,"***Already added")):$("",!0)],8,oe)]))),256)),t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[2]||(r[2]=a=>k())}," Create a new team? ")])):$("",!0),o.value.length>0&&l.value.total===0?(s(),n("div",re,[t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[3]||(r[3]=a=>k())}," We could not find teams. Do you want to create a new team? ")])):$("",!0)]))}},me={class:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4"},ce={class:"card"},ve={class:"card-header flex justify-between items-center"},fe={class:"text-xs italic"},_e={class:""},he={class:"flex justify-end"},pe={key:0},xe={key:1},ge={key:0},ye={key:1},$e={class:"py-2"},we={class:"font-bold"},ke={key:2},be={key:0,class:"mb-8"},Ce={class:"border-b py-1 flex justify-between items-end"},Te=["onClick"],Se={class:"flex justify-end items-center mt-4"},Ne={class:"w-full lg:w-1/3"},Ie={class:"card"},Ae={class:"card-header"},je={class:"text-xs italic"},Ve={key:0,class:"mb-8"},De={class:"border-b py-1 flex justify-between items-end"},Be=["onClick"],Me={class:"flex justify-end items-center mt-4"},Ue={class:"w-full lg:w-1/3"},qe={__name:"AdminTeamMerchantTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(h){const c=h,v=_(!1),f=_(!1),o=_({}),l=_({}),m=_({});z(()=>{p(),x()});function C(){v.value=!0}function k(){v.value=!1,f.value=!1,m.value={}}function p(a=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+c.teamId+"&page="+a+"&relations=merchantTeam").then(e=>{o.value=e.data.data}).catch(e=>{console.log(e)})}function x(a=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+c.teamId+"&page="+a+"&relations=team").then(e=>{l.value=e.data.data}).catch(e=>{console.log(e)})}function b(a){T.fire({title:"Are you sure you want to delete?",text:"This action cannot be undone. Please confirm if you wish to proceed.",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Delete merchant team",showCancelButton:!0}).then(e=>{e.isConfirmed&&axios.delete("/admin/team-merchant-teams/"+a).then(d=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{p(),x()})}).catch(d=>{console.log(d)})})}function u(){let a={team_id:c.teamId,merchant_team_id:m.value.id};axios.post("/admin/team-merchant-teams",a).then(e=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{m.value={},f.value=!1,p(),x()})}).catch(e=>{console.log(e)})}function r(a){m.value=a,v.value=!1,f.value=!0}return(a,e)=>(s(),n("div",me,[t("div",ce,[t("div",ve,[t("div",null,[e[3]||(e[3]=t("div",null," Merchant teams ",-1)),t("div",fe," These teams may redeem vouchers for "+w(h.teamName),1)]),t("div",_e,[t("div",he,[!v.value&&!f.value?(s(),n("div",pe,[i(I,{onClick:e[0]||(e[0]=d=>C()),class:"ms-4"},{default:g(()=>e[4]||(e[4]=[y(" Add Merchant Team ")])),_:1})])):(s(),n("div",xe,[i(I,{onClick:e[1]||(e[1]=d=>k()),class:"ms-4"},{default:g(()=>e[5]||(e[5]=[y(" Cancel ")])),_:1})]))])])]),v.value?(s(),n("div",ge,[e[6]||(e[6]=t("div",{class:"py-2"},"Select merchant team...",-1)),i(ue,{teamId:h.teamId,onTeamSelected:r},null,8,["teamId"])])):f.value?(s(),n("div",ye,[t("div",$e,[e[7]||(e[7]=y("Add ")),t("span",we,w(m.value.name),1),e[8]||(e[8]=y(" as merchant team? "))]),i(I,{onClick:e[2]||(e[2]=d=>u()),class:""},{default:g(()=>e[9]||(e[9]=[y(" Add ")])),_:1})])):(s(),n("div",ke,[o.value.data&&o.value.data.length?(s(),n("div",be,[(s(!0),n(S,null,A(o.value.data,d=>(s(),n("div",Ce,[i(N(V),{href:a.route("admin.team",d.merchant_team_id)},{default:g(()=>[i(M,{team:d.merchant_team},null,8,["team"])]),_:2},1032,["href"]),t("button",{onClick:j=>b(d.id),class:"text-xs text-red-500 flex items-center"},e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),y(" Delete ")]),8,Te)]))),256)),t("div",Se,[t("div",Ne,[i(B,{onSetDataPage:p,"pagination-data":o.value},null,8,["pagination-data"])])])])):$("",!0)]))]),t("div",Ie,[t("div",Ae,[t("div",null," Teams "+w(h.teamName)+" is merchant for ",1),t("div",je,w(h.teamName)+" may redeem vouchers for these teams ",1)]),l.value.data&&l.value.data.length?(s(),n("div",Ve,[(s(!0),n(S,null,A(l.value.data,d=>(s(),n("div",De,[i(N(V),{href:a.route("admin.team",d.team_id)},{default:g(()=>[i(M,{team:d.team},null,8,["team"])]),_:2},1032,["href"]),t("button",{onClick:j=>b(d.id),class:"text-xs text-red-500 flex items-center"},e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),y(" Delete ")]),8,Be)]))),256)),t("div",Me,[t("div",Ue,[i(B,{onSetDataPage:x,"pagination-data":l.value},null,8,["pagination-data"])])])])):$("",!0)])]))}},Pe={key:0},ze={key:1},Fe={key:0,class:"mt-4"},Ee={class:"border-b py-1"},Ke=["onClick"],Oe={key:0,class:"text-red-500 text-xs italic pl-2"},We={key:1},Le={__name:"AdminTeamServiceTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(h,{emit:c}){const v=h,f=_(!1),o=_(""),l=_({}),m=c;function C(){axios.get("/admin/teams?where[]=name,like,*"+o.value+"*&limit=100&relations=teamsThisTeamIsServiceFor").then(u=>{l.value=u.data.data}).catch(u=>{console.log(u)})}function k(){f.value=!0,l.value={}}function p(u){x(u)}function x(u){m("teamSelected",u),o.value="",l.value={}}function b(u){return u.teams_this_team_is_service_for.find(r=>r.team_id===v.teamId)}return(u,r)=>f.value?(s(),n("div",Pe,[i(O,{searchStr:o.value,onTeamCreated:p},null,8,["searchStr"])])):(s(),n("div",ze,[t("div",null,[i(U,{for:"name",value:"Team name(Type to search and press Enter)"}),i(D,{onKeyup:r[0]||(r[0]=K(q(a=>C(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:o.value,"onUpdate:modelValue":r[1]||(r[1]=a=>o.value=a),required:""},null,8,["modelValue"])]),o.value.length>0&&l.value.total>0?(s(),n("div",Fe,[(s(!0),n(S,null,A(l.value.data,a=>(s(),n("div",Ee,[t("button",{onClick:e=>x(a),class:"flex justify-start items-end"},[i(M,{team:a},null,8,["team"]),b(a)?(s(),n("span",Oe,"***Already added")):$("",!0)],8,Ke)]))),256)),t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[2]||(r[2]=a=>k())}," Create a new team? ")])):$("",!0),o.value.length>0&&l.value.total===0?(s(),n("div",We,[t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[3]||(r[3]=a=>k())}," We could not find teams. Do you want to create a new team? ")])):$("",!0)]))}},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4"},Ye={class:"card"},Ze={class:"card-header flex justify-between items-center"},Ge={class:"text-xs italic"},He={class:""},Je={class:"flex justify-end"},Qe={class:"flex justify-end"},Xe={key:0},et={key:1},tt={key:0},at={key:1},st={class:"py-2"},nt={class:"font-bold"},it={key:2},lt={key:0,class:"mb-8"},ot={class:"border-b py-1 flex justify-between items-end"},dt=["onClick"],rt={class:"flex justify-end items-center mt-4"},ut={class:"w-full lg:w-1/3"},mt={class:"card"},ct={class:"card-header"},vt={class:"text-xs italic"},ft={key:0,class:"mb-8"},_t={class:"border-b py-1 flex justify-between items-end"},ht=["onClick"],pt={class:"flex justify-end items-center mt-4"},xt={class:"w-full lg:w-1/3"},gt={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(h){const c=h,v=_(!1),f=_(!1),o=_({}),l=_({}),m=_({});z(()=>{p(),x()});function C(){v.value=!0}function k(){v.value=!1,f.value=!1,m.value={}}function p(a=1){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+c.teamId+"&page="+a+"&relations=serviceTeam").then(e=>{o.value=e.data.data}).catch(e=>{console.log(e)})}function x(a=1){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+c.teamId+"&page="+a+"&relations=team").then(e=>{l.value=e.data.data}).catch(e=>{console.log(e)})}function b(a){T.fire({title:"Are you sure you want to delete?",text:"This action cannot be undone. Please confirm if you wish to proceed.",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Delete service team",showCancelButton:!0}).then(e=>{e.isConfirmed&&axios.delete("/admin/team-service-teams/"+a).then(d=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{p(),x()})}).catch(d=>{console.log(d)})})}function u(){let a={team_id:c.teamId,service_team_id:m.value.id};axios.post("/admin/team-service-teams",a).then(e=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{m.value={},f.value=!1,p(),x()})}).catch(e=>{console.log(e)})}function r(a){m.value=a,v.value=!1,f.value=!0}return(a,e)=>(s(),n("div",Re,[t("div",Ye,[t("div",Ze,[t("div",null,[e[3]||(e[3]=t("div",null," Service teams ",-1)),t("div",Ge," These teams may distribute vouchers for redemption at "+w(h.teamName),1)]),t("div",He,[t("div",Je,[t("div",Qe,[!v.value&&!f.value?(s(),n("div",Xe,[i(I,{onClick:e[0]||(e[0]=d=>C()),class:"ms-4"},{default:g(()=>e[4]||(e[4]=[y(" Add Service Team ")])),_:1})])):(s(),n("div",et,[i(I,{onClick:e[1]||(e[1]=d=>k()),class:"ms-4"},{default:g(()=>e[5]||(e[5]=[y(" Cancel ")])),_:1})]))])])])]),v.value?(s(),n("div",tt,[e[6]||(e[6]=t("div",{class:"py-2"},"Select service team...",-1)),i(Le,{teamId:h.teamId,onTeamSelected:r},null,8,["teamId"])])):f.value?(s(),n("div",at,[t("div",st,[e[7]||(e[7]=y("Adding ")),t("span",nt,w(m.value.name),1),e[8]||(e[8]=y(" as service team?"))]),i(I,{onClick:e[2]||(e[2]=d=>u()),class:""},{default:g(()=>e[9]||(e[9]=[y(" Add ")])),_:1})])):(s(),n("div",it,[o.value.data&&o.value.data.length?(s(),n("div",lt,[(s(!0),n(S,null,A(o.value.data,d=>(s(),n("div",ot,[i(N(V),{href:a.route("admin.team",d.service_team_id)},{default:g(()=>[i(M,{team:d.service_team},null,8,["team"])]),_:2},1032,["href"]),t("button",{onClick:j=>b(d.id),class:"text-xs text-red-500 flex items-center"},e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),y(" Delete ")]),8,dt)]))),256)),t("div",rt,[t("div",ut,[i(B,{onSetDataPage:p,"pagination-data":o.value},null,8,["pagination-data"])])])])):$("",!0)]))]),t("div",mt,[t("div",ct,[t("div",null," Teams "+w(h.teamName)+" is service for ",1),t("div",vt,w(h.teamName)+" may distribute vouchers to these teams ",1)]),l.value.data&&l.value.data.length?(s(),n("div",ft,[(s(!0),n(S,null,A(l.value.data,d=>(s(),n("div",_t,[i(N(V),{href:a.route("admin.team",d.team_id)},{default:g(()=>[i(M,{team:d.team},null,8,["team"])]),_:2},1032,["href"]),t("button",{onClick:j=>b(d.id),class:"text-xs text-red-500 flex items-center"},e[11]||(e[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),y(" Delete ")]),8,ht)]))),256)),t("div",pt,[t("div",xt,[i(B,{onSetDataPage:x,"pagination-data":l.value},null,8,["pagination-data"])])])])):$("",!0)])]))}},yt={key:0},$t={class:"flex items-center justify-end mt-4"},wt={key:1},kt={key:0,class:"mt-4"},bt=["onClick"],Ct={key:1},Tt={__name:"AdminUserSelectComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup(h,{emit:c}){const v=h,f=_(!1),o=_({name:"",email:"",current_team_id:null}),l=_(""),m=_({}),C=c;function k(){o.value.current_team_id=v.teamId,axios.post("admin/users",o.value).then(u=>{let r=u.data.data.id;b(r),o.value={name:"",email:"",current_team_id:null},f.value=!1}).catch(u=>{console.log(u)})}function p(){axios.get("/admin/users?where[]=name,like,*"+l.value+"*&limit=100").then(u=>{m.value=u.data.data}).catch(u=>{console.log(u)})}function x(){f.value=!0,m.value={},o.value.name=l.value}function b(u){C("createNewTeamUser",u),l.value="",m.value={}}return(u,r)=>f.value?(s(),n("div",yt,[t("div",null,[i(U,{for:"name",value:"Name"}),i(D,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:o.value.name,"onUpdate:modelValue":r[0]||(r[0]=a=>o.value.name=a),required:""},null,8,["modelValue"])]),t("div",null,[i(U,{for:"email",value:"Email"}),i(D,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:o.value.email,"onUpdate:modelValue":r[1]||(r[1]=a=>o.value.email=a),required:""},null,8,["modelValue"])]),t("div",$t,[i(I,{onClick:r[2]||(r[2]=q(a=>k(),["prevent"])),class:W(["ms-4",{"opacity-25":!o.value.name||!o.value.email}]),disabled:!o.value.name||!o.value.email},{default:g(()=>r[7]||(r[7]=[y(" Submit ")])),_:1},8,["class","disabled"])])])):(s(),n("div",wt,[t("div",null,[i(U,{for:"name",value:"Find A User"}),i(D,{onKeyup:r[3]||(r[3]=a=>p()),modelValue:l.value,"onUpdate:modelValue":r[4]||(r[4]=a=>l.value=a),class:"mt-1 block w-full",placeholder:"Search by name..",type:"text"},null,8,["modelValue"])]),l.value.length>0&&m.value.total>0?(s(),n("div",kt,[(s(!0),n(S,null,A(m.value.data,a=>(s(),n("a",{href:"#",onClick:e=>b(a.id),class:"border-b py-1",tabindex:"0"},[i(Z,{user:a},null,8,["user"])],8,bt))),256)),t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[5]||(r[5]=a=>x())}," Create a new user? ")])):$("",!0),l.value.length>0&&m.value.total===0?(s(),n("div",Ct,[t("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[6]||(r[6]=a=>x())}," We could not find users. Do you want to create a new user? ")])):$("",!0)]))}},St={class:"card"},Nt={class:"card-header flex justify-between"},It={class:"grid gap-4 grid-cols-6 mt-8"},At={key:0},jt={key:1},Vt=["src"],Dt={class:"flex justify-end items-center mt-4"},Bt={class:"w-full lg:w-1/3"},Mt={__name:"AdminTeamVoucherTemplatesList",props:{team:{type:Object,required:!0}},setup(h){const c=h,v=_({});function f(o=1){var l;axios.get("/admin/team-voucher-templates?cached=false&where[]=team_id,"+((l=c.team)==null?void 0:l.id)+"&page="+o).then(m=>{v.value=m.data.data}).catch(m=>{T.fire({icon:"error",title:"Oops!",text:m.response.data.message})})}return f(),(o,l)=>(s(),n("div",St,[t("div",Nt,[l[1]||(l[1]=t("div",null," Voucher Templates ",-1)),t("div",null,[i(N(V),{href:"/admin/team-voucher-templates/new?teamId="+h.team.id},{default:g(()=>[i(I,{class:""},{default:g(()=>l[0]||(l[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),y(" New Template ")])),_:1})]),_:1},8,["href"])])]),t("div",It,[(s(!0),n(S,null,A(v.value.data,m=>(s(),n("div",null,[m.archived_at?(s(),n("div",At,l[2]||(l[2]=[t("div",{class:"border-2 text-center rounded-lg border-dashed p-2 border-red-300 text-red-300 font-bold"}," Archived ",-1)]))):(s(),n("div",jt,l[3]||(l[3]=[t("div",{class:"border-2 text-center rounded-lg border-dashed p-2 border-green-300 text-green-300 font-bold"}," Active ",-1)]))),i(N(V),{href:"/admin/team-voucher-template/"+m.id},{default:g(()=>[t("img",{src:m.example_template_image_url,alt:"",class:"border rounded"},null,8,Vt)]),_:2},1032,["href"])]))),256))]),t("div",Dt,[t("div",Bt,[i(B,{onSetDataPage:f,"pagination-data":v.value},null,8,["pagination-data"])])])]))}},Ut={class:"card"},qt={class:""},Pt={class:"card"},zt={class:"flex justify-start items-center"},Ft={class:"text-xs mr-2"},Et={key:0,class:"mt-2 flex justify-end"},Kt={class:"card"},Ot={key:0},Wt={class:"flex justify-between items-center hover:opacity-75"},Lt={class:"flex justify-end items-center"},Rt={key:0,class:"pr-2 text-xs"},Yt={class:"flex"},Zt={key:0},Gt={key:1,class:"px-2"},Ht={key:2,class:"px-2"},Jt={class:"flex justify-end items-center mt-4"},Qt={class:"w-full lg:w-1/3"},Xt={class:"card"},ea={class:"container mx-auto"},ta={class:"container mx-auto"},aa={class:"card"},sa={class:"card"},na={class:"card"},ia={class:"card"},la={key:0,class:"container mx-auto"},Sa={__name:"Team",props:{id:{required:!0,type:Number}},setup(h){P.extend(J),P.extend(Q);const c=h,v=_(!1),f=_(10),o=_(""),l=_({}),m=_({});z(()=>{k(),p()});function C(a){let e={user_id:a,team_id:c.id};axios.post("/admin/team-users",e).then(d=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{p()})}).catch(d=>{console.log(d)})}function k(){axios.get("/admin/teams/"+c.id+"?cached=false").then(a=>{l.value=a.data.data,o.value=l.value.name}).catch(a=>{console.log(a)})}function p(a=1){axios.get("/admin/team-users?cached=false&page="+a+"&where[]=team_id,"+c.id+"&relations=user&limit="+f.value+"&orderBy=id,desc").then(e=>{m.value=e.data.data}).catch(e=>{console.log(e)})}function x(a){v.value=!0;let e={send_invite_email:!0};axios.put("/admin/team-users/"+a.id,e).then(d=>{p(),v.value=!1}).catch(d=>{console.log(d),v.value=!1})}function b(a){T.fire({icon:"warning",title:"Are you sure?",text:"This will remove this user from this team. You can always add them back.",showConfirmButton:!0,showCancelButton:!0}).then(e=>{e.isConfirmed&&axios.delete("/admin/team-users/"+a.id).then(d=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{p()})}).catch(d=>{console.log(d)})})}function u(a){p(a)}function r(){let a={name:o.value};axios.put("/admin/teams/"+c.id,a).then(e=>{T.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{k()})}).catch(e=>{console.log(e)})}return(a,e)=>(s(),n(S,null,[i(N(L),{title:"Team"}),i(R,null,{header:g(()=>[i(Y)]),default:g(()=>[t("div",Ut,[t("div",qt,[t("h2",null,w(l.value.name),1),t("div",null,"#"+w(c.id),1)])]),t("div",Pt,[e[3]||(e[3]=t("div",{class:"card-header"}," Team details ",-1)),t("div",zt,[t("div",Ft,"#"+w(l.value.id),1),i(D,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=d=>o.value=d)},null,8,["modelValue"])]),o.value!==l.value.name?(s(),n("div",Et,[i(I,{onClick:e[1]||(e[1]=d=>r())},{default:g(()=>e[2]||(e[2]=[y("Update")])),_:1})])):$("",!0)]),t("div",Kt,[i(H,{loading:v.value},null,8,["loading"]),e[6]||(e[6]=t("div",{class:"card-header"}," Team members ",-1)),m.value.data&&m.value.data.length>0?(s(),n("div",Ot,[(s(!0),n(S,null,A(m.value.data,d=>(s(),n("div",Wt,[i(N(V),{href:a.route("admin.user",d.user_id),class:"border-b p-2 mr-2 flex-grow flex justify-between items-center hover:no-underline"},{default:g(()=>{var j;return[t("div",null,w((j=d.user)==null?void 0:j.name),1),t("div",Lt,[d.invitation_sent_at?(s(),n("div",Rt," Invited: "+w(N(P).utc(d.invitation_sent_at).fromNow()),1)):$("",!0),e[4]||(e[4]=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})],-1))])]}),_:2},1032,["href"]),t("div",Yt,[i(G,{onClick:j=>x(d),class:"mr-2"},{default:g(()=>[t("div",null,[d.invitation_sent_at?(s(),n("div",Zt,"Resend Invite")):v.value?(s(),n("div",Gt,"Sending..")):(s(),n("div",Ht,"Send Invite"))])]),_:2},1032,["onClick"]),i(X,{onClick:q(j=>b(d),["prevent"])},{default:g(()=>e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-3 font-bold"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1)])),_:2},1032,["onClick"])])]))),256))])):$("",!0),t("div",Jt,[t("div",Qt,[i(B,{onSetDataPage:u,"pagination-data":m.value},null,8,["pagination-data"])])])]),t("div",Xt,[e[7]||(e[7]=t("div",{class:"card-header"}," Add user to team ",-1)),i(Tt,{teamId:c.id,onCreateNewTeamUser:C},null,8,["teamId"])]),t("div",ea,[i(qe,{teamId:c.id,teamName:l.value.name},null,8,["teamId","teamName"])]),t("div",ta,[i(gt,{teamId:c.id,teamName:l.value.name},null,8,["teamId","teamName"])]),t("div",aa,[e[8]||(e[8]=t("div",{class:"card-header"}," Voucher sets created by team ",-1)),i(F,{"team-id":c.id,"filter-voucher-sets":"created_by_team_id"},null,8,["team-id"])]),t("div",sa,[e[9]||(e[9]=t("div",{class:"card-header"}," Voucher sets allocated to team ",-1)),i(F,{"team-id":c.id,"filter-voucher-sets":"allocated_to_service_team_id"},null,8,["team-id"])]),t("div",na,[e[10]||(e[10]=t("div",{class:"card-header"}," Vouchers created by team ",-1)),i(E,{"team-id":c.id,"filter-vouchers":"created_by_team_id"},null,8,["team-id"])]),t("div",ia,[e[11]||(e[11]=t("div",{class:"card-header"}," Vouchers allocated to team ",-1)),i(E,{"team-id":c.id,"filter-vouchers":"allocated_to_service_team_id"},null,8,["team-id"])]),l.value.id?(s(),n("div",la,[i(Mt,{team:l.value},null,8,["team"])])):$("",!0),e[12]||(e[12]=t("div",{class:"p-32"},null,-1))]),_:1})],64))}};export{Sa as default};
