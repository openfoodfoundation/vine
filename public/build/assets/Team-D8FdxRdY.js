import{b as a,c as s,d as e,t as N,r as p,a as i,j as G,k as O,F as A,g as I,f as b,o as W,w as k,e as $,u as V,i as D,n as R,Z as Y,l as Z,v as H}from"./app-DAMU3Vsb.js";import{S as j,_ as J}from"./AuthenticatedLayout-BUPPfdhf.js";import{_ as Q}from"./AdminTopNavigation-DhGdPzlz.js";import{P as U}from"./PaginatorComponent-CoSTMxRA.js";import{P as B}from"./PrimaryButton-CIB81Yr_.js";import{_ as M}from"./TextInput-CvMe3C5R.js";import{_ as q}from"./InputLabel-Wt1TYZ0A.js";import{_ as L}from"./AdminTeamCreateComponent-9Mr34fB9.js";import{_ as X}from"./AdminUserDetailsComponent-DStHbtVS.js";import{_ as ee}from"./SecondaryButton-CDQDA5dD.js";import{_ as te}from"./AjaxLoadingIndicator-jzrn0AI8.js";import{d as F}from"./dayjs.min-LcFuhhy0.js";import{r as ae}from"./relativeTime-Bgw1Nd-u.js";import{u as se}from"./utc-D9fONLNZ.js";import{D as ne}from"./DangerButton-Dm1RaOMo.js";import{_ as E}from"./VoucherSetsComponent-BkEVj6A7.js";import{_ as K}from"./VouchersComponent-B1EjqngZ.js";import"./ApplicationLogo-DKaozThB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"flex justify-start items-center"},oe={class:"text-xs mr-2"},le={class:""},P={__name:"AdminTeamDetailsComponent",props:{team:{required:!0,type:Object}},setup(x){const c=x;return(f,_)=>(a(),s("div",ie,[e("div",oe,"#"+N(c.team.id),1),e("div",le,N(c.team.name),1)]))}},de={key:0},re={key:1},ue={key:0,class:"mt-4"},me={class:"border-b py-1"},ce=["onClick"],ve={key:0,class:"text-red-500 text-xs italic pl-2"},fe={key:1},_e={__name:"AdminTeamMerchantTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(x,{emit:c}){const f=x,_=p(!1),l=p(""),o=p({}),m=c;function g(){axios.get("/admin/teams?where[]=name,like,*"+l.value+"*&limit=100&relations=teamsThisTeamIsMerchantFor").then(u=>{o.value=u.data.data}).catch(u=>{console.log(u)})}function C(){_.value=!0,o.value={}}function T(u){w(u)}function w(u){m("teamSelected",u),l.value="",o.value={}}function S(u){return u.teams_this_team_is_merchant_for.find(r=>r.team_id===f.teamId)}return(u,r)=>_.value?(a(),s("div",de,[i(L,{searchStr:l.value,onTeamCreated:T},null,8,["searchStr"])])):(a(),s("div",re,[e("div",null,[i(q,{for:"name",value:"Team name(Type to search and press Enter)"}),i(M,{onKeyup:r[0]||(r[0]=G(O(n=>g(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=n=>l.value=n),required:""},null,8,["modelValue"])]),l.value.length>0&&o.value.total>0?(a(),s("div",ue,[(a(!0),s(A,null,I(o.value.data,n=>(a(),s("div",me,[e("button",{onClick:t=>w(n),class:"flex justify-start items-end"},[i(P,{team:n},null,8,["team"]),S(n)?(a(),s("span",ve,"***Already added")):b("",!0)],8,ce)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[2]||(r[2]=n=>C())}," Create a new team? ")])):b("",!0),l.value.length>0&&o.value.total===0?(a(),s("div",fe,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[3]||(r[3]=n=>C())}," We could not find teams. Do you want to create a new team? ")])):b("",!0)]))}},he={class:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4"},pe={class:"card"},ye={class:"card-header flex justify-between items-center"},xe={class:"text-xs italic"},ge={class:""},we={class:"flex justify-end"},$e={key:0},ke={key:1},be={key:0},Ce={key:1},Te={class:"py-2"},Se={class:"font-bold"},Ne={key:2},je={key:0,class:"mb-8"},Ae={class:"border-b py-1 flex justify-between items-end"},Ie=["onClick"],Ve={class:"flex justify-end items-center mt-4"},Be={class:"w-full lg:w-1/3"},De={class:"card"},Me={class:"card-header"},Ue={key:0},Pe={class:"text-xs italic"},qe={key:0,class:"mb-8"},ze={class:"border-b py-1 flex justify-between items-end"},Oe=["onClick"],Fe={class:"flex justify-end items-center mt-4"},We={class:"w-full lg:w-1/3"},Ee={__name:"AdminTeamMerchantTeamsComponent",props:{team:{required:!0,type:Object}},setup(x){const c=x,f=p(!1),_=p(!1),l=p({}),o=p({}),m=p({});W(()=>{T(),w()});function g(){f.value=!0}function C(){f.value=!1,_.value=!1,m.value={}}function T(n=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=team_id,"+c.team.id+"&page="+n+"&relations=merchantTeam").then(t=>{l.value=t.data.data}).catch(t=>{console.log(t)})}function w(n=1){axios.get("/admin/team-merchant-teams?cached=false&where[]=merchant_team_id,"+c.team.id+"&page="+n+"&relations=team").then(t=>{o.value=t.data.data}).catch(t=>{console.log(t)})}function S(n){j.fire({title:"Are you sure you want to delete?",text:"This action cannot be undone. Please confirm if you wish to proceed.",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Delete merchant team",showCancelButton:!0}).then(t=>{t.isConfirmed&&axios.delete("/admin/team-merchant-teams/"+n).then(v=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{T(),w()})}).catch(v=>{console.log(v)})})}function u(){if(c.team.country_id===m.value.country_id){let n={team_id:c.team.id,merchant_team_id:m.value.id};axios.post("/admin/team-merchant-teams",n).then(t=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{m.value={},_.value=!1,T(),w()})}).catch(t=>{console.log(t)})}else j.fire({title:"Country / Currency mismatch",html:"Selected merchant ("+m.value.name+") is not sharing same country as the team ("+c.team.name+"). We cannot add merchant which has different country/currency. Please update.",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Got it!"}).then(n=>{m.value={},_.value=!1})}function r(n){m.value=n,f.value=!1,_.value=!0}return(n,t)=>(a(),s("div",he,[e("div",pe,[e("div",ye,[e("div",null,[t[3]||(t[3]=e("div",null," Merchant teams ",-1)),e("div",xe," These teams may redeem vouchers for "+N(x.team.name),1)]),e("div",ge,[e("div",we,[!f.value&&!_.value?(a(),s("div",$e,[i(B,{onClick:t[0]||(t[0]=v=>g()),class:"ms-4"},{default:k(()=>t[4]||(t[4]=[$(" Add Merchant Team ")])),_:1})])):(a(),s("div",ke,[i(B,{onClick:t[1]||(t[1]=v=>C()),class:"ms-4"},{default:k(()=>t[5]||(t[5]=[$(" Cancel ")])),_:1})]))])])]),f.value?(a(),s("div",be,[t[6]||(t[6]=e("div",{class:"py-2"},"Select merchant team...",-1)),i(_e,{teamId:x.team.id,onTeamSelected:r},null,8,["teamId"])])):_.value?(a(),s("div",Ce,[e("div",Te,[t[7]||(t[7]=$("Add ")),e("span",Se,N(m.value.name),1),t[8]||(t[8]=$(" as merchant team? "))]),i(B,{onClick:t[2]||(t[2]=v=>u()),class:""},{default:k(()=>t[9]||(t[9]=[$(" Add ")])),_:1})])):(a(),s("div",Ne,[l.value.data&&l.value.data.length?(a(),s("div",je,[(a(!0),s(A,null,I(l.value.data,v=>(a(),s("div",Ae,[i(V(D),{href:n.route("admin.team",v.merchant_team_id)},{default:k(()=>[i(P,{team:v.merchant_team},null,8,["team"])]),_:2},1032,["href"]),e("button",{onClick:y=>S(v.id),class:"text-xs text-red-500 flex items-center"},t[10]||(t[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),$(" Delete ")]),8,Ie)]))),256)),e("div",Ve,[e("div",Be,[i(U,{onSetDataPage:T,"pagination-data":l.value},null,8,["pagination-data"])])])])):b("",!0)]))]),e("div",De,[e("div",Me,[x.team.name?(a(),s("div",Ue," Teams "+N(x.team.name)+" is merchant for ",1)):b("",!0),e("div",Pe,N(x.team.name)+" may redeem vouchers for these teams ",1)]),o.value.data&&o.value.data.length?(a(),s("div",qe,[(a(!0),s(A,null,I(o.value.data,v=>(a(),s("div",ze,[i(V(D),{href:n.route("admin.team",v.team_id)},{default:k(()=>[i(P,{team:v.team},null,8,["team"])]),_:2},1032,["href"]),e("button",{onClick:y=>S(v.id),class:"text-xs text-red-500 flex items-center"},t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),$(" Delete ")]),8,Oe)]))),256)),e("div",Fe,[e("div",We,[i(U,{onSetDataPage:w,"pagination-data":o.value},null,8,["pagination-data"])])])])):b("",!0)])]))}},Ke={key:0},Ge={key:1},Le={key:0,class:"mt-4"},Re={class:"border-b py-1"},Ye=["onClick"],Ze={key:0,class:"text-red-500 text-xs italic pl-2"},He={key:1},Je={__name:"AdminTeamServiceTeamSelectComponent",props:{teamId:{required:!1,default:null}},emits:["teamSelected"],setup(x,{emit:c}){const f=x,_=p(!1),l=p(""),o=p({}),m=c;function g(){axios.get("/admin/teams?where[]=name,like,*"+l.value+"*&limit=100&relations=teamsThisTeamIsServiceFor").then(u=>{o.value=u.data.data}).catch(u=>{console.log(u)})}function C(){_.value=!0,o.value={}}function T(u){w(u)}function w(u){m("teamSelected",u),l.value="",o.value={}}function S(u){return u.teams_this_team_is_service_for.find(r=>r.team_id===f.teamId)}return(u,r)=>_.value?(a(),s("div",Ke,[i(L,{searchStr:l.value,onTeamCreated:T},null,8,["searchStr"])])):(a(),s("div",Ge,[e("div",null,[i(q,{for:"name",value:"Team name(Type to search and press Enter)"}),i(M,{onKeyup:r[0]||(r[0]=G(O(n=>g(),["prevent"]),["enter"])),id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=n=>l.value=n),required:""},null,8,["modelValue"])]),l.value.length>0&&o.value.total>0?(a(),s("div",Le,[(a(!0),s(A,null,I(o.value.data,n=>(a(),s("div",Re,[e("button",{onClick:t=>w(n),class:"flex justify-start items-end"},[i(P,{team:n},null,8,["team"]),S(n)?(a(),s("span",Ze,"***Already added")):b("",!0)],8,Ye)]))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[2]||(r[2]=n=>C())}," Create a new team? ")])):b("",!0),l.value.length>0&&o.value.total===0?(a(),s("div",He,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[3]||(r[3]=n=>C())}," We could not find teams. Do you want to create a new team? ")])):b("",!0)]))}},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-0 md:gap-4"},Xe={class:"card"},et={class:"card-header flex justify-between items-center"},tt={class:"text-xs italic"},at={class:""},st={class:"flex justify-end"},nt={class:"flex justify-end"},it={key:0},ot={key:1},lt={key:0},dt={key:1},rt={class:"py-2"},ut={class:"font-bold"},mt={key:2},ct={key:0,class:"mb-8"},vt={class:"border-b py-1 flex justify-between items-end"},ft=["onClick"],_t={class:"flex justify-end items-center mt-4"},ht={class:"w-full lg:w-1/3"},pt={class:"card"},yt={class:"card-header"},xt={class:"text-xs italic"},gt={key:0,class:"mb-8"},wt={class:"border-b py-1 flex justify-between items-end"},$t=["onClick"],kt={class:"flex justify-end items-center mt-4"},bt={class:"w-full lg:w-1/3"},Ct={__name:"AdminTeamServiceTeamsComponent",props:{teamId:{required:!0,type:Number},teamName:{required:!0}},setup(x){const c=x,f=p(!1),_=p(!1),l=p({}),o=p({}),m=p({});W(()=>{T(),w()});function g(){f.value=!0}function C(){f.value=!1,_.value=!1,m.value={}}function T(n=1){axios.get("/admin/team-service-teams?cached=false&where[]=team_id,"+c.teamId+"&page="+n+"&relations=serviceTeam").then(t=>{l.value=t.data.data}).catch(t=>{console.log(t)})}function w(n=1){axios.get("/admin/team-service-teams?cached=false&where[]=service_team_id,"+c.teamId+"&page="+n+"&relations=team").then(t=>{o.value=t.data.data}).catch(t=>{console.log(t)})}function S(n){j.fire({title:"Are you sure you want to delete?",text:"This action cannot be undone. Please confirm if you wish to proceed.",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Delete service team",showCancelButton:!0}).then(t=>{t.isConfirmed&&axios.delete("/admin/team-service-teams/"+n).then(v=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{T(),w()})}).catch(v=>{console.log(v)})})}function u(){let n={team_id:c.teamId,service_team_id:m.value.id};axios.post("/admin/team-service-teams",n).then(t=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{m.value={},_.value=!1,T(),w()})}).catch(t=>{console.log(t)})}function r(n){m.value=n,f.value=!1,_.value=!0}return(n,t)=>(a(),s("div",Qe,[e("div",Xe,[e("div",et,[e("div",null,[t[3]||(t[3]=e("div",null," Service teams ",-1)),e("div",tt," These teams may distribute vouchers for redemption at "+N(x.teamName),1)]),e("div",at,[e("div",st,[e("div",nt,[!f.value&&!_.value?(a(),s("div",it,[i(B,{onClick:t[0]||(t[0]=v=>g()),class:"ms-4"},{default:k(()=>t[4]||(t[4]=[$(" Add Service Team ")])),_:1})])):(a(),s("div",ot,[i(B,{onClick:t[1]||(t[1]=v=>C()),class:"ms-4"},{default:k(()=>t[5]||(t[5]=[$(" Cancel ")])),_:1})]))])])])]),f.value?(a(),s("div",lt,[t[6]||(t[6]=e("div",{class:"py-2"},"Select service team...",-1)),i(Je,{teamId:x.teamId,onTeamSelected:r},null,8,["teamId"])])):_.value?(a(),s("div",dt,[e("div",rt,[t[7]||(t[7]=$("Adding ")),e("span",ut,N(m.value.name),1),t[8]||(t[8]=$(" as service team?"))]),i(B,{onClick:t[2]||(t[2]=v=>u()),class:""},{default:k(()=>t[9]||(t[9]=[$(" Add ")])),_:1})])):(a(),s("div",mt,[l.value.data&&l.value.data.length?(a(),s("div",ct,[(a(!0),s(A,null,I(l.value.data,v=>(a(),s("div",vt,[i(V(D),{href:n.route("admin.team",v.service_team_id)},{default:k(()=>[i(P,{team:v.service_team},null,8,["team"])]),_:2},1032,["href"]),e("button",{onClick:y=>S(v.id),class:"text-xs text-red-500 flex items-center"},t[10]||(t[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),$(" Delete ")]),8,ft)]))),256)),e("div",_t,[e("div",ht,[i(U,{onSetDataPage:T,"pagination-data":l.value},null,8,["pagination-data"])])])])):b("",!0)]))]),e("div",pt,[e("div",yt,[e("div",null," Teams "+N(x.teamName)+" is service for ",1),e("div",xt,N(x.teamName)+" may distribute vouchers to these teams ",1)]),o.value.data&&o.value.data.length?(a(),s("div",gt,[(a(!0),s(A,null,I(o.value.data,v=>(a(),s("div",wt,[i(V(D),{href:n.route("admin.team",v.team_id)},{default:k(()=>[i(P,{team:v.team},null,8,["team"])]),_:2},1032,["href"]),e("button",{onClick:y=>S(v.id),class:"text-xs text-red-500 flex items-center"},t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"size-3"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),$(" Delete ")]),8,$t)]))),256)),e("div",kt,[e("div",bt,[i(U,{onSetDataPage:w,"pagination-data":o.value},null,8,["pagination-data"])])])])):b("",!0)])]))}},Tt={key:0},St={class:"flex items-center justify-end mt-4"},Nt={key:1},jt={key:0,class:"mt-4"},At=["onClick"],It={key:1},Vt={__name:"AdminUserSelectComponent",props:{teamId:{required:!0,type:Number}},emits:["createNewTeamUser"],setup(x,{emit:c}){const f=x,_=p(!1),l=p({name:"",email:"",current_team_id:null}),o=p(""),m=p({}),g=c;function C(){l.value.current_team_id=f.teamId,axios.post("admin/users",l.value).then(u=>{let r=u.data.data.id;S(r),l.value={name:"",email:"",current_team_id:null},_.value=!1}).catch(u=>{console.log(u)})}function T(){axios.get("/admin/users?where[]=name,like,*"+o.value+"*&limit=100").then(u=>{m.value=u.data.data}).catch(u=>{console.log(u)})}function w(){_.value=!0,m.value={},l.value.name=o.value}function S(u){g("createNewTeamUser",u),o.value="",m.value={}}return(u,r)=>_.value?(a(),s("div",Tt,[e("div",null,[i(q,{for:"name",value:"Name"}),i(M,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:l.value.name,"onUpdate:modelValue":r[0]||(r[0]=n=>l.value.name=n),required:""},null,8,["modelValue"])]),e("div",null,[i(q,{for:"email",value:"Email"}),i(M,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:l.value.email,"onUpdate:modelValue":r[1]||(r[1]=n=>l.value.email=n),required:""},null,8,["modelValue"])]),e("div",St,[i(B,{onClick:r[2]||(r[2]=O(n=>C(),["prevent"])),class:R(["ms-4",{"opacity-25":!l.value.name||!l.value.email}]),disabled:!l.value.name||!l.value.email},{default:k(()=>r[7]||(r[7]=[$(" Submit ")])),_:1},8,["class","disabled"])])])):(a(),s("div",Nt,[e("div",null,[i(q,{for:"name",value:"Find A User"}),i(M,{onKeyup:r[3]||(r[3]=n=>T()),modelValue:o.value,"onUpdate:modelValue":r[4]||(r[4]=n=>o.value=n),class:"mt-1 block w-full",placeholder:"Search by name..",type:"text"},null,8,["modelValue"])]),o.value.length>0&&m.value.total>0?(a(),s("div",jt,[(a(!0),s(A,null,I(m.value.data,n=>(a(),s("a",{href:"#",onClick:t=>S(n.id),class:"border-b py-1",tabindex:"0"},[i(X,{user:n},null,8,["user"])],8,At))),256)),e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[5]||(r[5]=n=>w())}," Create a new user? ")])):b("",!0),o.value.length>0&&m.value.total===0?(a(),s("div",It,[e("div",{class:"text-red-500 text-sm mt-4 cursor-pointer hover:underline",onClick:r[6]||(r[6]=n=>w())}," We could not find users. Do you want to create a new user? ")])):b("",!0)]))}},Bt={class:"card"},Dt={class:"card-header flex justify-between"},Mt={class:"grid gap-4 grid-cols-6 mt-8"},Ut={key:0},Pt={key:1},qt=["src"],zt={class:"flex justify-end items-center mt-4"},Ot={class:"w-full lg:w-1/3"},Ft={__name:"AdminTeamVoucherTemplatesList",props:{team:{type:Object,required:!0}},setup(x){const c=x,f=p({});function _(l=1){var o;axios.get("/admin/team-voucher-templates?cached=false&where[]=team_id,"+((o=c.team)==null?void 0:o.id)+"&page="+l).then(m=>{f.value=m.data.data}).catch(m=>{j.fire({icon:"error",title:"Oops!",text:m.response.data.message})})}return _(),(l,o)=>(a(),s("div",Bt,[e("div",Dt,[o[1]||(o[1]=e("div",null," Voucher Templates ",-1)),e("div",null,[i(V(D),{href:"/admin/team-voucher-templates/new?teamId="+x.team.id},{default:k(()=>[i(B,{class:""},{default:k(()=>o[0]||(o[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1),$(" New Template ")])),_:1})]),_:1},8,["href"])])]),e("div",Mt,[(a(!0),s(A,null,I(f.value.data,m=>(a(),s("div",null,[m.archived_at?(a(),s("div",Ut,o[2]||(o[2]=[e("div",{class:"border-2 text-center rounded-lg border-dashed p-2 border-red-300 text-red-300 font-bold"}," Archived ",-1)]))):(a(),s("div",Pt,o[3]||(o[3]=[e("div",{class:"border-2 text-center rounded-lg border-dashed p-2 border-green-300 text-green-300 font-bold"}," Active ",-1)]))),i(V(D),{href:"/admin/team-voucher-template/"+m.id},{default:k(()=>[e("img",{src:m.example_template_image_url,alt:"",class:"border rounded"},null,8,qt)]),_:2},1032,["href"])]))),256))]),e("div",zt,[e("div",Ot,[i(U,{onSetDataPage:_,"pagination-data":f.value},null,8,["pagination-data"])])])]))}},Wt={class:"card"},Et={class:""},Kt={class:"text-gray-300 pr-1"},Gt={class:"card"},Lt={class:"flex justify-start items-center mt-4"},Rt={for:"name",class:"w-full font-bold"},Yt={class:"flex justify-start items-center mt-4"},Zt={for:"country",class:"w-full font-bold"},Ht=["value"],Jt={key:0,class:"mt-8 flex justify-end"},Qt={class:"card"},Xt={key:0},ea={class:"flex justify-between items-center hover:opacity-75"},ta={class:"flex justify-end items-center"},aa={key:0,class:"pr-2 text-xs"},sa={class:"flex"},na={key:0},ia={key:1,class:"px-2"},oa={key:2,class:"px-2"},la={class:"flex justify-end items-center mt-4"},da={class:"w-full lg:w-1/3"},ra={class:"card"},ua={key:0,class:"container mx-auto"},ma={key:1,class:"container mx-auto"},ca={class:"card"},va={class:"card"},fa={class:"card"},_a={class:"card"},ha={key:2,class:"container mx-auto"},Ua={__name:"Team",props:{id:{required:!0,type:Number}},setup(x){F.extend(ae),F.extend(se);const c=x,f=p(!1),_=p(10),l=p(""),o=p(""),m=p({}),g=p({name:"",country_id:""}),C=p({});W(()=>{S(),u(),w()});function T(y){let d={user_id:y,team_id:c.id};axios.post("/admin/team-users",d).then(h=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{u()})}).catch(h=>{console.log(h)})}function w(){axios.get("/countries?limit=300").then(y=>{m.value=y.data.data}).catch(y=>{console.log(y)})}function S(){axios.get("/admin/teams/"+c.id+"?cached=false").then(y=>{g.value=y.data.data,o.value=g.value.country_id,l.value=g.value.name}).catch(y=>{console.log(y)})}function u(y=1){axios.get("/admin/team-users?cached=false&page="+y+"&where[]=team_id,"+c.id+"&relations=user&limit="+_.value+"&orderBy=id,desc").then(d=>{C.value=d.data.data}).catch(d=>{console.log(d)})}function r(y){f.value=!0;let d={send_invite_email:!0};axios.put("/admin/team-users/"+y.id,d).then(h=>{u(),f.value=!1}).catch(h=>{console.log(h),f.value=!1})}function n(y){j.fire({icon:"warning",title:"Are you sure?",text:"This will remove this user from this team. You can always add them back.",showConfirmButton:!0,showCancelButton:!0}).then(d=>{d.isConfirmed&&axios.delete("/admin/team-users/"+y.id).then(h=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{u()})}).catch(h=>{console.log(h)})})}function t(y){u(y)}function v(){let y={name:l.value,country_id:o.value};g.value.country_id!==o.value?j.fire({title:"Wait...",icon:"warning",text:"It looks like you're changing this teams' country. Please be aware this will NOT update the selected currency for any of their existing voucher sets.",confirmButtonText:"I get it. Proceed.",cancelButtonText:"Go back",showCancelButton:!0,showConfirmButton:!0,allowOutsideClick:!1}).then(d=>{d.isDismissed||d.isConfirmed&&axios.put("/admin/teams/"+c.id,y).then(h=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{S()})}).catch(h=>{console.log(h)})}):axios.put("/admin/teams/"+c.id,y).then(d=>{j.fire({title:"Success!",icon:"success",timer:1e3}).then(()=>{S()})}).catch(d=>{console.log(d)})}return(y,d)=>(a(),s(A,null,[i(V(Y),{title:"Team"}),i(J,null,{header:k(()=>[i(Q)]),default:k(()=>[e("div",Wt,[e("div",Et,[e("h2",null,[e("span",Kt,"#"+N(c.id),1),$(" "+N(g.value.name),1)])])]),e("div",Gt,[d[6]||(d[6]=e("div",{class:"card-header"}," Team details ",-1)),e("div",Lt,[e("label",Rt,[d[3]||(d[3]=$(" Team Name: ")),i(M,{id:"name",type:"text",class:"mt-1 block w-full font-normal",modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=h=>l.value=h)},null,8,["modelValue"])])]),e("div",Yt,[e("label",Zt,[d[4]||(d[4]=$(" Country: ")),Z(e("select",{id:"country",class:"mt-1 block w-full font-normal","onUpdate:modelValue":d[1]||(d[1]=h=>o.value=h)},[(a(!0),s(A,null,I(m.value.data,h=>(a(),s("option",{value:h.id,key:h.id},N(h.name),9,Ht))),128))],512),[[H,o.value]])])]),l.value!==g.value.name||o.value!==g.value.country_id?(a(),s("div",Jt,[i(B,{onClick:d[2]||(d[2]=h=>v())},{default:k(()=>d[5]||(d[5]=[$("Update")])),_:1})])):b("",!0)]),e("div",Qt,[i(te,{loading:f.value},null,8,["loading"]),d[9]||(d[9]=e("div",{class:"card-header"}," Team members ",-1)),C.value.data&&C.value.data.length>0?(a(),s("div",Xt,[(a(!0),s(A,null,I(C.value.data,h=>(a(),s("div",ea,[i(V(D),{href:y.route("admin.user",h.user_id),class:"border-b p-2 mr-2 flex-grow flex justify-between items-center hover:no-underline"},{default:k(()=>{var z;return[e("div",null,N((z=h.user)==null?void 0:z.name),1),e("div",ta,[h.invitation_sent_at?(a(),s("div",aa," Invited: "+N(V(F).utc(h.invitation_sent_at).fromNow()),1)):b("",!0),d[7]||(d[7]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})],-1))])]}),_:2},1032,["href"]),e("div",sa,[i(ee,{onClick:z=>r(h),class:"mr-2"},{default:k(()=>[e("div",null,[h.invitation_sent_at?(a(),s("div",na,"Resend Invite")):f.value?(a(),s("div",ia,"Sending..")):(a(),s("div",oa,"Send Invite"))])]),_:2},1032,["onClick"]),i(ne,{onClick:O(z=>n(h),["prevent"])},{default:k(()=>d[8]||(d[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-3 font-bold"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1)])),_:2},1032,["onClick"])])]))),256))])):b("",!0),e("div",la,[e("div",da,[i(U,{onSetDataPage:t,"pagination-data":C.value},null,8,["pagination-data"])])])]),e("div",ra,[d[10]||(d[10]=e("div",{class:"card-header"}," Add user to team ",-1)),i(Vt,{teamId:c.id,onCreateNewTeamUser:T},null,8,["teamId"])]),g.value.id?(a(),s("div",ua,[i(Ee,{team:g.value},null,8,["team"])])):b("",!0),g.value.id?(a(),s("div",ma,[i(Ct,{teamId:c.id,teamName:g.value.name},null,8,["teamId","teamName"])])):b("",!0),e("div",ca,[d[11]||(d[11]=e("div",{class:"card-header"}," Voucher sets created by team ",-1)),i(E,{"team-id":c.id,"filter-voucher-sets":"created_by_team_id"},null,8,["team-id"])]),e("div",va,[d[12]||(d[12]=e("div",{class:"card-header"}," Voucher sets allocated to team ",-1)),i(E,{"team-id":c.id,"filter-voucher-sets":"allocated_to_service_team_id"},null,8,["team-id"])]),e("div",fa,[d[13]||(d[13]=e("div",{class:"card-header"}," Vouchers created by team ",-1)),i(K,{"team-id":c.id,"filter-vouchers":"created_by_team_id"},null,8,["team-id"])]),e("div",_a,[d[14]||(d[14]=e("div",{class:"card-header"}," Vouchers allocated to team ",-1)),i(K,{"team-id":c.id,"filter-vouchers":"allocated_to_service_team_id"},null,8,["team-id"])]),g.value.id?(a(),s("div",ha,[i(Ft,{team:g.value},null,8,["team"])])):b("",!0),d[15]||(d[15]=e("div",{class:"p-32"},null,-1))]),_:1})],64))}};export{Ua as default};
